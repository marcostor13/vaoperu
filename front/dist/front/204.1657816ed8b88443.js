"use strict";(self.webpackChunkfront=self.webpackChunkfront||[]).push([[204],{7828:(Z,C,s)=>{s.d(C,{H:()=>b});var t=s(5e3),h=s(5830);let b=(()=>{class c{constructor(e){this.api=e,this.model="category"}save(e){return this.api.api({service:e._id?`update-${this.model}/${e._id}`:`save-${this.model}`,type:e._id?"patch":"post",data:e})}updateAll(e){return this.api.api({service:`update-${this.model}-all`,type:"patch",data:e})}get(){return this.api.api({service:`get-${this.model}`,type:"get",data:null})}delete(e){return this.api.api({service:`delete-${this.model}/${e}`,type:"delete",data:null})}}return c.\u0275fac=function(e){return new(e||c)(t.LFG(h.s))},c.\u0275prov=t.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},5964:(Z,C,s)=>{s.d(C,{K:()=>b});var t=s(5e3),h=s(5830);let b=(()=>{class c{constructor(e){this.api=e,this.model="subcategory"}save(e){return this.api.api({service:e._id?`update-${this.model}/${e._id}`:`save-${this.model}`,type:e._id?"patch":"post",data:e})}updateAll(e){return this.api.api({service:`update-${this.model}-all`,type:"patch",data:e})}get(){return this.api.api({service:`get-${this.model}`,type:"get",data:null})}delete(e){return this.api.api({service:`delete-${this.model}/${e}`,type:"delete",data:null})}}return c.\u0275fac=function(e){return new(e||c)(t.LFG(h.s))},c.\u0275prov=t.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},5204:(Z,C,s)=>{s.r(C),s.d(C,{SubcategoryModule:()=>j});var t=s(9808),h=s(9812),b=s(6240);class c{constructor(){this.name="",this.image="",this.categoryId=""}}class _{constructor(){this._id=!1,this.name=!1,this.image=!1,this.categoryId=!1}}var e=s(5e3),l=s(5964),P=s(7828),A=s(1864),S=s(9783),I=s(7840),E=s(5315),v=s(4182),T=s(986),x=s(7307);function a(r,f){if(1&r){const i=e.EpF();e.TgZ(0,"div",21)(1,"div")(2,"span",22),e._uU(3,"Nombre :"),e.qZA(),e.TgZ(4,"span",23),e._uU(5),e.qZA()(),e.TgZ(6,"div")(7,"button",24),e.NdJ("click",function(){const m=e.CHM(i).$implicit;return e.oxw().addEdit(m)}),e._uU(8,"Editar"),e.qZA()()()}if(2&r){const i=f.$implicit;e.xp6(5),e.Oqu(i.name)}}function g(r,f){if(1&r&&(e.TgZ(0,"option",25),e._uU(1),e.qZA()),2&r){const i=f.$implicit;e.s9C("value",i._id),e.xp6(1),e.Oqu(i.name)}}const n=function(r){return{"background-image":r}};function p(r,f){if(1&r){const i=e.EpF();e.TgZ(0,"div",26)(1,"div",27)(2,"div",28),e.NdJ("click",function(){e.CHM(i);const u=e.oxw();return u.removeImage(u.currentImage)}),e._UZ(3,"i",29),e.qZA()()()}if(2&r){const i=e.oxw();e.xp6(1),e.Q6J("ngStyle",e.VKq(1,n,"url("+i.getBlobOrImage(i.currentImage)+")"))}}function d(r,f){if(1&r){const i=e.EpF();e.TgZ(0,"button",30),e.NdJ("click",function(u){e.CHM(i);const m=e.oxw();return m.confirm(u,m.currentItem)}),e._uU(1,"Eliminar"),e.qZA()}}const y=function(){return{"max-height":"30rem"}},L=function(r){return{invalid:r}},O=function(r){return{width:r}},w=[{path:"",component:(()=>{class r{constructor(i,o,u,m,D){this.subcategoryService=i,this.categoryService=o,this.general=u,this.confirmationService=m,this.messageService=D,this.subs=new b.Y,this.displayModal=!1,this.currentItem=new c,this.invalid=new _,this.images=[]}ngOnInit(){this.get(),this.getCategories()}get(){this.subs.add(this.subcategoryService.get().subscribe(i=>{this.items=i.data},i=>{this.messageService.add({severity:"error",summary:"Error",detail:i.error.message})}))}getCategories(){this.subs.add(this.categoryService.get().subscribe(i=>{this.categories=i.data},i=>{this.messageService.add({severity:"error",summary:"Error",detail:i.error.message})}))}validate(){this.invalid=new _;let i=!1;return this.currentItem.name||(i=!0,this.invalid.name=!0),this.currentImage||(i=!0,this.invalid.image=!0),i&&this.messageService.add({severity:"error",summary:"Error",detail:"Revise los campos"}),i}reset(){this.currentItem=new c,this.currentImage=null,this.uploadPercent=0}addEdit(i=null){i?(this.currentItem=i,i.image&&(this.currentImage={file:null,blob:null,url:i.image})):this.reset(),this.displayModal=!0}confirm(i,o){this.confirmationService.confirm({target:i.target,message:"\xbfSeg\xfaro que desea eliminar?",icon:"pi pi-exclamation-triangle",acceptLabel:"S\xed",rejectLabel:"No",accept:()=>{this.delete(o)},reject:()=>{}})}add(){this.subs.add(this.subcategoryService.save(this.currentItem).subscribe(i=>{this.messageService.add({severity:"success",summary:"Mensaje",detail:i.message}),this.currentItem=new c,this.currentItem._id||this.reset(),this.get()},i=>{this.messageService.add({severity:"error",summary:"Error",detail:i.error.message})}))}updateAll(){this.subs.add(this.subcategoryService.updateAll(this.items).subscribe(i=>{this.messageService.add({severity:"success",summary:"Mensaje",detail:i.message}),this.currentItem=new c,this.get()},i=>{this.messageService.add({severity:"error",summary:"Error",detail:i.error.message})}))}delete(i){i.image&&this.general.deleteImage(i.image).then(()=>{this.currentImage=null,this.subs.add(this.subcategoryService.delete(i._id).subscribe(o=>{this.messageService.add({severity:"success",summary:"Mensaje",detail:o.message}),this.currentItem=new c,this.get()},o=>{this.messageService.add({severity:"error",summary:"Error",detail:o.error.message})}))}).catch(o=>{this.messageService.add({severity:"error",summary:"Error",detail:"Error al eliminar la imagen"})})}removeImage(i){i.url&&(this.deleteImage=i,this.currentItem.image=""),this.currentImage=null}onUpload(i){i.currentFiles.map(o=>{const u=new FileReader;u.readAsDataURL(o),u.onload=()=>{this.currentImage={file:o,blob:u.result,url:null}}}),this.images=[]}presave(){var i;this.validate()||(this.general.isLoad(!0),this.deleteImage&&this.general.deleteImage(this.deleteImage.url).then(()=>{this.currentImage=null}).catch(o=>{this.messageService.add({severity:"error",summary:"Error",detail:"Error al eliminar la imagen"})}),(null===(i=this.currentImage)||void 0===i?void 0:i.file)?this.general.uploadImage(this.currentImage.file,"subcategories/").subscribe(o=>{"number"==typeof o?this.uploadPercent=o:(this.currentImage={file:null,blob:null,url:o},this.currentItem.image=o,this.add())}):this.add())}getBlobOrImage(i){return i.blob||i.url}}return r.\u0275fac=function(i){return new(i||r)(e.Y36(l.K),e.Y36(P.H),e.Y36(A.m),e.Y36(S.YP),e.Y36(S.ez))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-subcategory"]],decls:26,vars:35,consts:[[1,"p-5"],[1,"row","m-0","justify-content-between","align-items-center"],[1,"btn2",3,"click"],[1,"pi","pi-plus","mr-2"],[1,"mt-5"],["header","Lista de subcategor\xedas","filterPlaceholder","Buscar por nombre","filterBy","name",3,"value","listStyle","dragdrop","onReorder"],["pTemplate","item","class","mt-3"],["header","",3,"visible","modal","styleClass","baseZIndex","autoZIndex","draggable","resizable","visibleChange"],[1,"col-12","row","m-0","justify-content-center"],[1,"row","m-0","p-0","flex-column","col-12","col-md-6"],["type","text",3,"ngModel","ngClass","placeholder","keyup.enter","ngModelChange","keyup"],[1,"mt-2",3,"ngModel","ngModelChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"mt-2",3,"ngClass"],["styleClass","col-12 btn2","mode","basic","accept","image/*","uploadLabel","Subir","cancelLabel","Cancelar","invalidFileSizeMessageDetail","El tama\xf1o m\xe1ximo es {0}.",3,"fileLimit","maxFileSize","chooseLabel","files","auto","disabled","onSelect"],[1,"loading"],["class","row m-0 justify-content-center align-items-center mt-2",4,"ngIf"],[1,"btn1","mt-4",3,"click"],["class","btn3 bg-color6 pt-2 pb-2 mt-2",3,"click",4,"ngIf"],[3,"autoZIndex","baseZIndex"],["draggable","true",1,"item-list","row","justify-content-between","align-items-center","m-0","pl-2","pr-2"],[1,"font-700"],[1,"ml-3"],[1,"btn2","p-0","pl-3","pr-3",3,"click"],[3,"value"],[1,"row","m-0","justify-content-center","align-items-center","mt-2"],[1,"image-miniature",3,"ngStyle"],[1,"delete",3,"click"],[1,"pi","pi-trash","text-white","f-20"],[1,"btn3","bg-color6","pt-2","pb-2","mt-2",3,"click"]],template:function(i,o){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h4"),e._uU(3,"Subcategor\xedas"),e.qZA(),e.TgZ(4,"button",2),e.NdJ("click",function(){return o.addEdit()}),e._UZ(5,"i",3),e._uU(6," Agregar "),e.qZA()(),e.TgZ(7,"div",4)(8,"p-orderList",5),e.NdJ("onReorder",function(){return o.updateAll()}),e.YNc(9,a,9,1,"ng-template",6),e.qZA()()(),e.TgZ(10,"p-dialog",7),e.NdJ("visibleChange",function(m){return o.displayModal=m}),e.TgZ(11,"div",8)(12,"div",9)(13,"input",10),e.NdJ("keyup.enter",function(){return o.add()})("ngModelChange",function(m){return o.currentItem.name=m})("keyup",function(){return o.invalid.name=!1}),e.qZA(),e.TgZ(14,"select",11),e.NdJ("ngModelChange",function(m){return o.currentItem.categoryId=m}),e.TgZ(15,"option",12),e._uU(16,"Seleccione una categor\xeda"),e.qZA(),e.YNc(17,g,2,2,"option",13),e.qZA(),e.TgZ(18,"div",14)(19,"p-fileUpload",15),e.NdJ("onSelect",function(m){return o.onUpload(m),o.invalid.image=!1}),e.qZA(),e._UZ(20,"div",16),e.qZA(),e.YNc(21,p,4,3,"div",17),e.TgZ(22,"button",18),e.NdJ("click",function(){return o.presave()}),e._uU(23,"Guardar"),e.qZA(),e.YNc(24,d,2,0,"button",19),e.qZA()()(),e._UZ(25,"p-confirmPopup",20)),2&i&&(e.xp6(8),e.Q6J("value",o.items)("listStyle",e.DdM(28,y))("dragdrop",!0),e.xp6(2),e.Q6J("visible",o.displayModal)("modal",!0)("styleClass","modalLogin")("baseZIndex",1e4)("autoZIndex",!1)("draggable",!1)("resizable",!1),e.xp6(3),e.Q6J("ngModel",o.currentItem.name)("ngClass",e.VKq(29,L,o.invalid.name))("placeholder","Subcategor\xeda"),e.xp6(1),e.Q6J("ngModel",o.currentItem.categoryId),e.xp6(3),e.Q6J("ngForOf",o.categories),e.xp6(1),e.Q6J("ngClass",e.VKq(31,L,o.invalid.image)),e.xp6(1),e.Q6J("fileLimit",1)("maxFileSize",1e7)("chooseLabel","Subir \xcdcono")("files",o.images)("auto",!1)("disabled",!!o.currentImage),e.xp6(1),e.Akn(e.VKq(33,O,o.uploadPercent+"%")),e.xp6(1),e.Q6J("ngIf",o.currentImage),e.xp6(3),e.Q6J("ngIf",o.currentItem._id),e.xp6(1),e.Q6J("autoZIndex",!1)("baseZIndex",1000001))},directives:[I.F,S.jx,E.V,v.Fj,v.JJ,v.On,t.mk,v.EJ,v.YN,v.Kr,t.sg,T.p,t.O5,t.PC,x.P],styles:[""]}),r})()}];let k=(()=>{class r{}return r.\u0275fac=function(i){return new(i||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[[h.Bz.forChild(w)],h.Bz]}),r})();var J=s(7773);let j=(()=>{class r{}return r.\u0275fac=function(i){return new(i||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({providers:[S.YP],imports:[[t.ez,k,x.n,I.C,E.S,v.u5,J.EV,T.O]]}),r})()},7307:(Z,C,s)=>{s.d(C,{P:()=>T,n:()=>x});var t=s(5e3),h=s(9808),b=s(9783),c=s(845),_=s(5921),e=s(1777),l=s(5730);function P(a,g){if(1&a&&t._UZ(0,"i",8),2&a){const n=t.oxw(2);t.Tol(n.confirmation.icon),t.Q6J("ngClass","p-confirm-popup-icon")}}function A(a,g){if(1&a){const n=t.EpF();t.TgZ(0,"button",9),t.NdJ("click",function(){return t.CHM(n),t.oxw(2).reject()}),t.qZA()}if(2&a){const n=t.oxw(2);t.Tol(n.confirmation.rejectButtonStyleClass||"p-button-text"),t.Q6J("icon",n.confirmation.rejectIcon)("label",n.rejectButtonLabel)("ngClass","p-confirm-popup-reject p-button-sm"),t.uIk("aria-label",n.rejectButtonLabel)}}function S(a,g){if(1&a){const n=t.EpF();t.TgZ(0,"button",9),t.NdJ("click",function(){return t.CHM(n),t.oxw(2).accept()}),t.qZA()}if(2&a){const n=t.oxw(2);t.Tol(n.confirmation.acceptButtonStyleClass),t.Q6J("icon",n.confirmation.acceptIcon)("label",n.acceptButtonLabel)("ngClass","p-confirm-popup-accept p-button-sm"),t.uIk("aria-label",n.acceptButtonLabel)}}const I=function(a,g){return{showTransitionParams:a,hideTransitionParams:g}},E=function(a){return{value:"open",params:a}};function v(a,g){if(1&a){const n=t.EpF();t.TgZ(0,"div",1),t.NdJ("click",function(d){return t.CHM(n),t.oxw().onOverlayClick(d)})("@animation.start",function(d){return t.CHM(n),t.oxw().onAnimationStart(d)})("@animation.done",function(d){return t.CHM(n),t.oxw().onAnimationEnd(d)}),t.TgZ(1,"div",2,3),t.YNc(3,P,1,3,"i",4),t.TgZ(4,"span",5),t._uU(5),t.qZA()(),t.TgZ(6,"div",6),t.YNc(7,A,1,6,"button",7),t.YNc(8,S,1,6,"button",7),t.qZA()()}if(2&a){const n=t.oxw();t.Tol(n.styleClass),t.Q6J("ngClass","p-confirm-popup p-component")("ngStyle",n.style)("@animation",t.VKq(12,E,t.WLB(9,I,n.showTransitionOptions,n.hideTransitionOptions))),t.xp6(3),t.Q6J("ngIf",n.confirmation.icon),t.xp6(2),t.Oqu(n.confirmation.message),t.xp6(2),t.Q6J("ngIf",!1!==n.confirmation.rejectVisible),t.xp6(1),t.Q6J("ngIf",!1!==n.confirmation.acceptVisible)}}let T=(()=>{class a{constructor(n,p,d,y,L,O){this.el=n,this.confirmationService=p,this.renderer=d,this.cd=y,this.config=L,this.overlayService=O,this.defaultFocus="accept",this.showTransitionOptions=".12s cubic-bezier(0, 0, 0.2, 1)",this.hideTransitionOptions=".1s linear",this.autoZIndex=!0,this.baseZIndex=0,this.subscription=this.confirmationService.requireConfirmation$.subscribe(M=>{M?M.key===this.key&&(this.confirmation=M,this.confirmation.accept&&(this.confirmation.acceptEvent=new t.vpe,this.confirmation.acceptEvent.subscribe(this.confirmation.accept)),this.confirmation.reject&&(this.confirmation.rejectEvent=new t.vpe,this.confirmation.rejectEvent.subscribe(this.confirmation.reject)),this.visible=!0):this.hide()})}get visible(){return this._visible}set visible(n){this._visible=n,this.cd.markForCheck()}onAnimationStart(n){if("open"===n.toState){this.container=n.element,document.body.appendChild(this.container),this.align(),this.bindListeners();const p=this.getElementToFocus();p&&p.focus()}}onAnimationEnd(n){"void"===n.toState&&this.onContainerDestroy()}getElementToFocus(){switch(this.defaultFocus){case"accept":return l.p.findSingle(this.container,".p-confirm-popup-accept");case"reject":return l.p.findSingle(this.container,".p-confirm-popup-reject");case"none":return null}}align(){this.autoZIndex&&_.P9.set("overlay",this.container,this.config.zIndex.overlay),l.p.absolutePosition(this.container,this.confirmation.target);const n=l.p.getOffset(this.container),p=l.p.getOffset(this.confirmation.target);let d=0;n.left<p.left&&(d=p.left-n.left),this.container.style.setProperty("--overlayArrowLeft",`${d}px`),n.top<p.top&&l.p.addClass(this.container,"p-confirm-popup-flipped")}hide(){this.visible=!1}accept(){this.confirmation.acceptEvent&&this.confirmation.acceptEvent.emit(),this.hide()}reject(){this.confirmation.rejectEvent&&this.confirmation.rejectEvent.emit(),this.hide()}onOverlayClick(n){this.overlayService.add({originalEvent:n,target:this.el.nativeElement})}bindListeners(){this.bindDocumentClickListener(),this.bindDocumentResizeListener(),this.bindScrollListener()}unbindListeners(){this.unbindDocumentClickListener(),this.unbindDocumentResizeListener(),this.unbindScrollListener()}bindDocumentClickListener(){if(!this.documentClickListener){let n=l.p.isIOS()?"touchstart":"click";const p=this.el?this.el.nativeElement.ownerDocument:document;this.documentClickListener=this.renderer.listen(p,n,d=>{let y=this.confirmation.target;this.container!==d.target&&!this.container.contains(d.target)&&y!==d.target&&!y.contains(d.target)&&this.hide()})}}unbindDocumentClickListener(){this.documentClickListener&&(this.documentClickListener(),this.documentClickListener=null)}onWindowResize(){this.hide()}bindDocumentResizeListener(){this.documentResizeListener=this.onWindowResize.bind(this),window.addEventListener("resize",this.documentResizeListener)}unbindDocumentResizeListener(){this.documentResizeListener&&(window.removeEventListener("resize",this.documentResizeListener),this.documentResizeListener=null)}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new l.V(this.confirmation.target,()=>{this.visible&&this.hide()})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}unsubscribeConfirmationSubscriptions(){this.confirmation&&(this.confirmation.acceptEvent&&this.confirmation.acceptEvent.unsubscribe(),this.confirmation.rejectEvent&&this.confirmation.rejectEvent.unsubscribe())}onContainerDestroy(){this.unbindListeners(),this.unsubscribeConfirmationSubscriptions(),this.autoZIndex&&_.P9.clear(this.container),this.confirmation=null,this.container=null}restoreAppend(){this.container&&document.body.removeChild(this.container),this.onContainerDestroy()}get acceptButtonLabel(){return this.confirmation.acceptLabel||this.config.getTranslation(b.ws.ACCEPT)}get rejectButtonLabel(){return this.confirmation.rejectLabel||this.config.getTranslation(b.ws.REJECT)}ngOnDestroy(){this.restoreAppend(),this.subscription&&this.subscription.unsubscribe()}}return a.\u0275fac=function(n){return new(n||a)(t.Y36(t.SBq),t.Y36(b.YP),t.Y36(t.Qsj),t.Y36(t.sBO),t.Y36(b.b4),t.Y36(b.F0))},a.\u0275cmp=t.Xpm({type:a,selectors:[["p-confirmPopup"]],hostAttrs:[1,"p-element"],inputs:{key:"key",defaultFocus:"defaultFocus",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",style:"style",styleClass:"styleClass",visible:"visible"},decls:1,vars:1,consts:[[3,"ngClass","ngStyle","class","click",4,"ngIf"],[3,"ngClass","ngStyle","click"],[1,"p-confirm-popup-content"],["content",""],[3,"ngClass","class",4,"ngIf"],[1,"p-confirm-popup-message"],[1,"p-confirm-popup-footer"],["type","button","pButton","",3,"icon","label","ngClass","class","click",4,"ngIf"],[3,"ngClass"],["type","button","pButton","",3,"icon","label","ngClass","click"]],template:function(n,p){1&n&&t.YNc(0,v,9,14,"div",0),2&n&&t.Q6J("ngIf",p.visible)},directives:[h.O5,h.mk,h.PC,c.Hq],styles:['.p-confirm-popup{position:absolute;margin-top:10px;top:0;left:0}.p-confirm-popup-flipped{margin-top:0;margin-bottom:10px}.p-confirm-popup:after,.p-confirm-popup:before{bottom:100%;left:calc(var(--overlayArrowLeft, 0) + 1.25rem);content:" ";height:0;width:0;position:absolute;pointer-events:none}.p-confirm-popup:after{border-width:8px;margin-left:-8px}.p-confirm-popup:before{border-width:10px;margin-left:-10px}.p-confirm-popup-flipped:after,.p-confirm-popup-flipped:before{bottom:auto;top:100%}.p-confirm-popup.p-confirm-popup-flipped:after{border-bottom-color:transparent}.p-confirm-popup.p-confirm-popup-flipped:before{border-bottom-color:transparent}.p-confirm-popup .p-confirm-popup-content{display:flex;align-items:center}\n'],encapsulation:2,data:{animation:[(0,e.X$)("animation",[(0,e.SB)("void",(0,e.oB)({transform:"scaleY(0.8)",opacity:0})),(0,e.SB)("open",(0,e.oB)({transform:"translateY(0)",opacity:1})),(0,e.eR)("void => open",(0,e.jt)("{{showTransitionParams}}")),(0,e.eR)("open => void",(0,e.jt)("{{hideTransitionParams}}"))])]},changeDetection:0}),a})(),x=(()=>{class a{}return a.\u0275fac=function(n){return new(n||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[[h.ez,c.hJ]]}),a})()}}]);