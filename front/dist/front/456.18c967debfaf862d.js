(self.webpackChunkfront=self.webpackChunkfront||[]).push([[456],{907:(me,Et,V)=>{"use strict";V.d(Et,{V2:()=>kt,dD:()=>Wt});var c=V(5e3),St=V(4763),Qt=V.n(St),Rt=V(9808);const ie=["image"];function jt(W,G){1&W&&(c.TgZ(0,"div",6),c._UZ(1,"div",7),c.qZA())}function ae(W,G){if(1&W&&(c.TgZ(0,"div",8),c._uU(1),c.qZA()),2&W){const I=c.oxw();c.xp6(1),c.Oqu(I.loadImageErrorText)}}class st{constructor(){}}st.\u0275fac=function(G){return new(G||st)},st.\u0275prov=c.Yz7({token:st,factory:st.\u0275fac,providedIn:"root"}),st.ngInjectableDef=(0,c.Ez6)({factory:function(){return new st},token:st,providedIn:"root"});let kt=(()=>{class W{constructor(){this.cropperOptions={},this.export=new c.vpe,this.ready=new c.vpe,this.isLoading=!0}ngOnInit(){}imageLoaded(I){this.loadError=!1;const U=I.target;this.imageElement=U,this.cropperOptions.checkCrossOrigin&&(U.crossOrigin="anonymous"),U.addEventListener("ready",()=>{this.ready.emit(!0),this.isLoading=!1,this.cropbox&&this.cropper.setCropBoxData(this.cropbox)});let J=NaN;if(this.settings){const{width:R,height:et}=this.settings;J=R/et}this.cropperOptions=Object.assign({aspectRatio:J,movable:!1,scalable:!1,zoomable:!1,viewMode:1,checkCrossOrigin:!0},this.cropperOptions),this.cropper&&(this.cropper.destroy(),this.cropper=void 0),this.cropper=new(Qt())(U,this.cropperOptions)}imageLoadError(I){this.loadError=!0,this.isLoading=!1}exportCanvas(I){const U=this.cropper.getImageData(),J=this.cropper.getCropBoxData(),R=this.cropper.getCroppedCanvas(),et={imageData:U,cropData:J};new Promise(vt=>{if(I)return vt({dataUrl:R.toDataURL("image/png")});R.toBlob(Ft=>vt({blob:Ft}))}).then(vt=>{this.export.emit(Object.assign(et,vt))})}}return W.\u0275fac=function(I){return new(I||W)},W.\u0275cmp=c.Xpm({type:W,selectors:[["angular-cropper"]],viewQuery:function(I,U){if(1&I&&c.Gf(ie,5),2&I){let J;c.iGM(J=c.CRH())&&(U.image=J.first)}},inputs:{cropperOptions:"cropperOptions",imageUrl:"imageUrl",settings:"settings",cropbox:"cropbox",loadImageErrorText:"loadImageErrorText"},outputs:{export:"export",ready:"ready"},decls:6,vars:3,consts:[[1,"cropper-wrapper"],["class","loading-block",4,"ngIf"],["class","alert alert-warning",4,"ngIf"],[1,"cropper"],["alt","image",3,"src","load","error"],["image",""],[1,"loading-block"],[1,"spinner"],[1,"alert","alert-warning"]],template:function(I,U){1&I&&(c.TgZ(0,"div",0),c.YNc(1,jt,2,0,"div",1),c.YNc(2,ae,2,1,"div",2),c.TgZ(3,"div",3)(4,"img",4,5),c.NdJ("load",function(R){return U.imageLoaded(R)})("error",function(R){return U.imageLoadError(R)}),c.qZA()()()),2&I&&(c.xp6(1),c.Q6J("ngIf",U.isLoading),c.xp6(1),c.Q6J("ngIf",U.loadError),c.xp6(2),c.Q6J("src",U.imageUrl,c.LSH))},directives:[Rt.O5],styles:[":host{display:block}.cropper img{max-width:100%;max-height:100%;height:auto}.cropper-wrapper{position:relative;min-height:80px}.cropper-wrapper .loading-block{position:absolute;top:0;left:0;width:100%;height:100%}.cropper-wrapper .loading-block .spinner{width:31px;height:31px;margin:0 auto;border:2px solid rgba(97,100,193,.98);border-radius:50%;border-left-color:transparent;border-right-color:transparent;-webkit-animation:425ms linear infinite cssload-spin;position:absolute;top:calc(50% - 15px);left:calc(50% - 15px);animation:425ms linear infinite cssload-spin}@-webkit-keyframes cssload-spin{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes cssload-spin{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}/*!\n * Cropper.js v1.4.1\n * https://fengyuanchen.github.io/cropperjs\n *\n * Copyright 2015-present Chen Fengyuan\n * Released under the MIT license\n *\n * Date: 2018-07-15T09:54:43.167Z\n */.cropper-container{direction:ltr;font-size:0;line-height:0;position:relative;touch-action:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.cropper-container img{display:block;height:100%;image-orientation:0deg;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;width:100%}.cropper-canvas,.cropper-crop-box,.cropper-drag-box,.cropper-modal,.cropper-wrap-box{bottom:0;left:0;position:absolute;right:0;top:0}.cropper-canvas,.cropper-wrap-box{overflow:hidden}.cropper-drag-box{background-color:#fff;opacity:0}.cropper-modal{background-color:#000;opacity:.5}.cropper-view-box{display:block;height:100%;outline:#39f solid 1px;overflow:hidden;width:100%}.cropper-dashed{border:0 dashed #eee;display:block;opacity:.5;position:absolute}.cropper-dashed.dashed-h{border-bottom-width:1px;border-top-width:1px;height:calc(100% / 3);left:0;top:calc(100% / 3);width:100%}.cropper-dashed.dashed-v{border-left-width:1px;border-right-width:1px;height:100%;left:calc(100% / 3);top:0;width:calc(100% / 3)}.cropper-center{display:block;height:0;left:50%;opacity:.75;position:absolute;top:50%;width:0}.cropper-center:after,.cropper-center:before{background-color:#eee;content:' ';display:block;position:absolute}.cropper-center:before{height:1px;left:-3px;top:0;width:7px}.cropper-center:after{height:7px;left:0;top:-3px;width:1px}.cropper-face,.cropper-line,.cropper-point{display:block;height:100%;opacity:.1;position:absolute;width:100%}.cropper-face{background-color:#fff;left:0;top:0}.cropper-line{background-color:#39f}.cropper-line.line-e{cursor:ew-resize;right:-3px;top:0;width:5px}.cropper-line.line-n{cursor:ns-resize;height:5px;left:0;top:-3px}.cropper-line.line-w{cursor:ew-resize;left:-3px;top:0;width:5px}.cropper-line.line-s{bottom:-3px;cursor:ns-resize;height:5px;left:0}.cropper-point{background-color:#39f;height:5px;opacity:.75;width:5px}.cropper-point.point-e{cursor:ew-resize;margin-top:-3px;right:-3px;top:50%}.cropper-point.point-n{cursor:ns-resize;left:50%;margin-left:-3px;top:-3px}.cropper-point.point-w{cursor:ew-resize;left:-3px;margin-top:-3px;top:50%}.cropper-point.point-s{bottom:-3px;cursor:s-resize;left:50%;margin-left:-3px}.cropper-point.point-ne{cursor:nesw-resize;right:-3px;top:-3px}.cropper-point.point-nw{cursor:nwse-resize;left:-3px;top:-3px}.cropper-point.point-sw{bottom:-3px;cursor:nesw-resize;left:-3px}.cropper-point.point-se{bottom:-3px;cursor:nwse-resize;height:20px;opacity:1;right:-3px;width:20px}@media (min-width:768px){.cropper-point.point-se{height:15px;width:15px}}@media (min-width:992px){.cropper-point.point-se{height:10px;width:10px}}@media (min-width:1200px){.cropper-point.point-se{height:5px;opacity:.75;width:5px}}.cropper-point.point-se:before{background-color:#39f;bottom:-50%;content:' ';display:block;height:200%;opacity:0;position:absolute;right:-50%;width:200%}.cropper-invisible{opacity:0}.cropper-bg{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAAA3NCSVQICAjb4U/gAAAABlBMVEXMzMz////TjRV2AAAACXBIWXMAAArrAAAK6wGCiw1aAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M26LyyjAAAABFJREFUCJlj+M/AgBVhF/0PAH6/D/HkDxOGAAAAAElFTkSuQmCC)}.cropper-hide{display:block;height:0;position:absolute;width:0}.cropper-hidden{display:none!important}.cropper-move{cursor:move}.cropper-crop{cursor:crosshair}.cropper-disabled .cropper-drag-box,.cropper-disabled .cropper-face,.cropper-disabled .cropper-line,.cropper-disabled .cropper-point{cursor:not-allowed}"],encapsulation:2}),W})(),Wt=(()=>{class W{}return W.\u0275fac=function(I){return new(I||W)},W.\u0275mod=c.oAB({type:W}),W.\u0275inj=c.cJS({imports:[[Rt.ez]]}),W})()},4763:function(me){me.exports=function(){"use strict";function Et(s,t){var a=Object.keys(s);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(s);t&&(e=e.filter(function(l){return Object.getOwnPropertyDescriptor(s,l).enumerable})),a.push.apply(a,e)}return a}function V(s){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Et(Object(a),!0).forEach(function(e){ie(s,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(a)):Et(Object(a)).forEach(function(e){Object.defineProperty(s,e,Object.getOwnPropertyDescriptor(a,e))})}return s}function c(s){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(s)}function St(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function Qt(s,t){for(var a=0;a<t.length;a++){var e=t[a];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(s,e.key,e)}}function ie(s,t,a){return t in s?Object.defineProperty(s,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):s[t]=a,s}function jt(s){return function ae(s){if(Array.isArray(s))return Wt(s)}(s)||function st(s){if("undefined"!=typeof Symbol&&null!=s[Symbol.iterator]||null!=s["@@iterator"])return Array.from(s)}(s)||function kt(s,t){if(s){if("string"==typeof s)return Wt(s,t);var a=Object.prototype.toString.call(s).slice(8,-1);if("Object"===a&&s.constructor&&(a=s.constructor.name),"Map"===a||"Set"===a)return Array.from(s);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Wt(s,t)}}(s)||function W(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wt(s,t){(null==t||t>s.length)&&(t=s.length);for(var a=0,e=new Array(t);a<t;a++)e[a]=s[a];return e}var G="undefined"!=typeof window&&void 0!==window.document,I=G?window:{},U=!(!G||!I.document.documentElement)&&"ontouchstart"in I.document.documentElement,J=!!G&&"PointerEvent"in I,R="cropper",ft="n",Nt="ne",yt="nw",Tt="se",It="sw",Zt="".concat(R,"-crop"),oe="".concat(R,"-disabled"),Z="".concat(R,"-hidden"),ne="".concat(R,"-hide"),Ae="".concat(R,"-invisible"),$="".concat(R,"-modal"),Vt="".concat(R,"-move"),Dt="".concat(R,"Action"),Lt="".concat(R,"Preview"),Gt="crop",qt="crop",Jt="cropend",ce="cropmove",Kt="cropstart",pe="dblclick",le=J?"pointerdown":U?"touchstart":"mousedown",de=J?"pointermove":U?"touchmove":"mousemove",ye=J?"pointerup pointercancel":U?"touchend touchcancel":"mouseup",f="ready",u="resize",i="wheel",r="zoom",o="image/jpeg",n=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,d=/^data:/,x=/^data:image\/jpeg;base64,/,C=/^img|canvas$/i,O={viewMode:0,dragMode:Gt,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},P=Number.isNaN||I.isNaN;function A(s){return"number"==typeof s&&!P(s)}var q=function(t){return t>0&&t<1/0};function bt(s){return void 0===s}function ut(s){return"object"===c(s)&&null!==s}var ht=Object.prototype.hasOwnProperty;function ct(s){if(!ut(s))return!1;try{var t=s.constructor,a=t.prototype;return t&&a&&ht.call(a,"isPrototypeOf")}catch(e){return!1}}function F(s){return"function"==typeof s}var fe=Array.prototype.slice;function $t(s){return Array.from?Array.from(s):fe.call(s)}function N(s,t){return s&&F(t)&&(Array.isArray(s)||A(s.length)?$t(s).forEach(function(a,e){t.call(s,a,e,s)}):ut(s)&&Object.keys(s).forEach(function(a){t.call(s,s[a],a,s)})),s}var B=Object.assign||function(t){for(var a=arguments.length,e=new Array(a>1?a-1:0),l=1;l<a;l++)e[l-1]=arguments[l];return ut(t)&&e.length>0&&e.forEach(function(h){ut(h)&&Object.keys(h).forEach(function(p){t[p]=h[p]})}),t},be=/\.\d*(?:0|9){12}\d*$/;function Mt(s){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return be.test(s)?Math.round(s*t)/t:s}var te=/^width|height|left|top|marginLeft|marginTop$/;function it(s,t){var a=s.style;N(t,function(e,l){te.test(l)&&A(e)&&(e="".concat(e,"px")),a[l]=e})}function L(s,t){if(t){if(A(s.length))return void N(s,function(e){L(e,t)});if(s.classList)return void s.classList.add(t);var a=s.className.trim();a?a.indexOf(t)<0&&(s.className="".concat(a," ").concat(t)):s.className=t}}function at(s,t){if(t){if(A(s.length))return void N(s,function(a){at(a,t)});if(s.classList)return void s.classList.remove(t);s.className.indexOf(t)>=0&&(s.className=s.className.replace(t,""))}}function _t(s,t,a){if(t){if(A(s.length))return void N(s,function(e){_t(e,t,a)});a?L(s,t):at(s,t)}}var Yt=/([a-z\d])([A-Z])/g;function Pt(s){return s.replace(Yt,"$1-$2").toLowerCase()}function lt(s,t){return ut(s[t])?s[t]:s.dataset?s.dataset[t]:s.getAttribute("data-".concat(Pt(t)))}function rt(s,t,a){ut(a)?s[t]=a:s.dataset?s.dataset[t]=a:s.setAttribute("data-".concat(Pt(t)),a)}var Ee=/\s\s*/,Se=function(){var s=!1;if(G){var t=!1,a=function(){},e=Object.defineProperty({},"once",{get:function(){return s=!0,t},set:function(h){t=h}});I.addEventListener("test",a,e),I.removeEventListener("test",a,e)}return s}();function pt(s,t,a){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=a;t.trim().split(Ee).forEach(function(h){if(!Se){var p=s.listeners;p&&p[h]&&p[h][a]&&(l=p[h][a],delete p[h][a],0===Object.keys(p[h]).length&&delete p[h],0===Object.keys(p).length&&delete s.listeners)}s.removeEventListener(h,l,e)})}function ot(s,t,a){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=a;t.trim().split(Ee).forEach(function(h){if(e.once&&!Se){var p=s.listeners,g=void 0===p?{}:p;l=function(){delete g[h][a],s.removeEventListener(h,l,e);for(var w=arguments.length,m=new Array(w),v=0;v<w;v++)m[v]=arguments[v];a.apply(s,m)},g[h]||(g[h]={}),g[h][a]&&s.removeEventListener(h,g[h][a],e),g[h][a]=l,s.listeners=g}s.addEventListener(h,l,e)})}function Xt(s,t,a){var e;return F(Event)&&F(CustomEvent)?e=new CustomEvent(t,{detail:a,bubbles:!0,cancelable:!0}):(e=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,a),s.dispatchEvent(e)}function Re(s){var t=s.getBoundingClientRect();return{left:t.left+(window.pageXOffset-document.documentElement.clientLeft),top:t.top+(window.pageYOffset-document.documentElement.clientTop)}}var Me=I.location,Ne=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function Oe(s){var t=s.match(Ne);return null!==t&&(t[1]!==Me.protocol||t[2]!==Me.hostname||t[3]!==Me.port)}function Te(s){var t="timestamp=".concat((new Date).getTime());return s+(-1===s.indexOf("?")?"?":"&")+t}function ee(s){var t=s.rotate,a=s.scaleX,e=s.scaleY,l=s.translateX,h=s.translateY,p=[];A(l)&&0!==l&&p.push("translateX(".concat(l,"px)")),A(h)&&0!==h&&p.push("translateY(".concat(h,"px)")),A(t)&&0!==t&&p.push("rotate(".concat(t,"deg)")),A(a)&&1!==a&&p.push("scaleX(".concat(a,")")),A(e)&&1!==e&&p.push("scaleY(".concat(e,")"));var g=p.length?p.join(" "):"none";return{WebkitTransform:g,msTransform:g,transform:g}}function ue(s,t){var a=s.pageX,e=s.pageY,l={endX:a,endY:e};return t?l:V({startX:a,startY:e},l)}function Ct(s){var t=s.aspectRatio,a=s.height,e=s.width,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"contain",h=q(e),p=q(a);if(h&&p){var g=a*t;"contain"===l&&g>e||"cover"===l&&g<e?a=e/t:e=a*t}else h?a=e/t:p&&(e=a*t);return{width:e,height:a}}function Pe(s,t,a,e){var l=t.aspectRatio,h=t.naturalWidth,p=t.naturalHeight,g=t.rotate,b=void 0===g?0:g,w=t.scaleX,m=void 0===w?1:w,v=t.scaleY,y=void 0===v?1:v,T=a.aspectRatio,S=a.naturalWidth,k=a.naturalHeight,D=e.fillColor,X=void 0===D?"transparent":D,j=e.imageSmoothingEnabled,Y=void 0===j||j,gt=e.imageSmoothingQuality,tt=void 0===gt?"low":gt,M=e.maxWidth,z=void 0===M?1/0:M,Q=e.maxHeight,nt=void 0===Q?1/0:Q,mt=e.minWidth,zt=void 0===mt?0:mt,Ht=e.minHeight,At=void 0===Ht?0:Ht,dt=document.createElement("canvas"),K=dt.getContext("2d"),Bt=Ct({aspectRatio:T,width:z,height:nt}),ge=Ct({aspectRatio:T,width:zt,height:At},"cover"),_e=Math.min(Bt.width,Math.max(ge.width,S)),Ce=Math.min(Bt.height,Math.max(ge.height,k)),ze=Ct({aspectRatio:l,width:z,height:nt}),He=Ct({aspectRatio:l,width:zt,height:At},"cover"),Be=Math.min(ze.width,Math.max(He.width,h)),ke=Math.min(ze.height,Math.max(He.height,p)),ii=[-Be/2,-ke/2,Be,ke];return dt.width=Mt(_e),dt.height=Mt(Ce),K.fillStyle=X,K.fillRect(0,0,_e,Ce),K.save(),K.translate(_e/2,Ce/2),K.rotate(b*Math.PI/180),K.scale(m,y),K.imageSmoothingEnabled=Y,K.imageSmoothingQuality=tt,K.drawImage.apply(K,[s].concat(jt(ii.map(function(ai){return Math.floor(Mt(ai))})))),K.restore(),dt}var Ie=String.fromCharCode;var Qe=/^data:.*,/;function Ze(s){var a,t=new DataView(s);try{var e,l,h;if(255===t.getUint8(0)&&216===t.getUint8(1))for(var p=t.byteLength,g=2;g+1<p;){if(255===t.getUint8(g)&&225===t.getUint8(g+1)){l=g;break}g+=1}if(l){var w=l+10;if("Exif"===function Xe(s,t,a){var e="";a+=t;for(var l=t;l<a;l+=1)e+=Ie(s.getUint8(l));return e}(t,l+4,4)){var m=t.getUint16(w);if(((e=18761===m)||19789===m)&&42===t.getUint16(w+2,e)){var v=t.getUint32(w+4,e);v>=8&&(h=w+v)}}}if(h){var T,S,y=t.getUint16(h,e);for(S=0;S<y;S+=1)if(274===t.getUint16(T=h+12*S+2,e)){a=t.getUint16(T+=8,e),t.setUint16(T,1,e);break}}}catch(k){a=1}return a}var Ge={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var t=this.element,a=this.options,e=this.container,l=this.cropper,h=Number(a.minContainerWidth),p=Number(a.minContainerHeight);L(l,Z),at(t,Z);var g={width:Math.max(e.offsetWidth,h>=0?h:200),height:Math.max(e.offsetHeight,p>=0?p:100)};this.containerData=g,it(l,{width:g.width,height:g.height}),L(t,Z),at(l,Z)},initCanvas:function(){var t=this.containerData,a=this.imageData,e=this.options.viewMode,l=Math.abs(a.rotate)%180==90,h=l?a.naturalHeight:a.naturalWidth,p=l?a.naturalWidth:a.naturalHeight,g=h/p,b=t.width,w=t.height;t.height*g>t.width?3===e?b=t.height*g:w=t.width/g:3===e?w=t.width/g:b=t.height*g;var m={aspectRatio:g,naturalWidth:h,naturalHeight:p,width:b,height:w};this.canvasData=m,this.limited=1===e||2===e,this.limitCanvas(!0,!0),m.width=Math.min(Math.max(m.width,m.minWidth),m.maxWidth),m.height=Math.min(Math.max(m.height,m.minHeight),m.maxHeight),m.left=(t.width-m.width)/2,m.top=(t.height-m.height)/2,m.oldLeft=m.left,m.oldTop=m.top,this.initialCanvasData=B({},m)},limitCanvas:function(t,a){var e=this.options,l=this.containerData,h=this.canvasData,p=this.cropBoxData,g=e.viewMode,b=h.aspectRatio,w=this.cropped&&p;if(t){var m=Number(e.minCanvasWidth)||0,v=Number(e.minCanvasHeight)||0;g>1?(m=Math.max(m,l.width),v=Math.max(v,l.height),3===g&&(v*b>m?m=v*b:v=m/b)):g>0&&(m?m=Math.max(m,w?p.width:0):v?v=Math.max(v,w?p.height:0):w&&((v=p.height)*b>(m=p.width)?m=v*b:v=m/b));var y=Ct({aspectRatio:b,width:m,height:v});v=y.height,h.minWidth=m=y.width,h.minHeight=v,h.maxWidth=1/0,h.maxHeight=1/0}if(a)if(g>(w?0:1)){var T=l.width-h.width,S=l.height-h.height;h.minLeft=Math.min(0,T),h.minTop=Math.min(0,S),h.maxLeft=Math.max(0,T),h.maxTop=Math.max(0,S),w&&this.limited&&(h.minLeft=Math.min(p.left,p.left+(p.width-h.width)),h.minTop=Math.min(p.top,p.top+(p.height-h.height)),h.maxLeft=p.left,h.maxTop=p.top,2===g&&(h.width>=l.width&&(h.minLeft=Math.min(0,T),h.maxLeft=Math.max(0,T)),h.height>=l.height&&(h.minTop=Math.min(0,S),h.maxTop=Math.max(0,S))))}else h.minLeft=-h.width,h.minTop=-h.height,h.maxLeft=l.width,h.maxTop=l.height},renderCanvas:function(t,a){var e=this.canvasData,l=this.imageData;if(a){var h=function Ye(s){var t=s.width,a=s.height,e=s.degree;if(90==(e=Math.abs(e)%180))return{width:a,height:t};var l=e%90*Math.PI/180,h=Math.sin(l),p=Math.cos(l),g=t*p+a*h,b=t*h+a*p;return e>90?{width:b,height:g}:{width:g,height:b}}({width:l.naturalWidth*Math.abs(l.scaleX||1),height:l.naturalHeight*Math.abs(l.scaleY||1),degree:l.rotate||0}),p=h.width,g=h.height,b=e.width*(p/e.naturalWidth),w=e.height*(g/e.naturalHeight);e.left-=(b-e.width)/2,e.top-=(w-e.height)/2,e.width=b,e.height=w,e.aspectRatio=p/g,e.naturalWidth=p,e.naturalHeight=g,this.limitCanvas(!0,!1)}(e.width>e.maxWidth||e.width<e.minWidth)&&(e.left=e.oldLeft),(e.height>e.maxHeight||e.height<e.minHeight)&&(e.top=e.oldTop),e.width=Math.min(Math.max(e.width,e.minWidth),e.maxWidth),e.height=Math.min(Math.max(e.height,e.minHeight),e.maxHeight),this.limitCanvas(!1,!0),e.left=Math.min(Math.max(e.left,e.minLeft),e.maxLeft),e.top=Math.min(Math.max(e.top,e.minTop),e.maxTop),e.oldLeft=e.left,e.oldTop=e.top,it(this.canvas,B({width:e.width,height:e.height},ee({translateX:e.left,translateY:e.top}))),this.renderImage(t),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(t){var a=this.canvasData,e=this.imageData,l=e.naturalWidth*(a.width/a.naturalWidth),h=e.naturalHeight*(a.height/a.naturalHeight);B(e,{width:l,height:h,left:(a.width-l)/2,top:(a.height-h)/2}),it(this.image,B({width:e.width,height:e.height},ee(B({translateX:e.left,translateY:e.top},e)))),t&&this.output()},initCropBox:function(){var t=this.options,a=this.canvasData,e=t.aspectRatio||t.initialAspectRatio,l=Number(t.autoCropArea)||.8,h={width:a.width,height:a.height};e&&(a.height*e>a.width?h.height=h.width/e:h.width=h.height*e),this.cropBoxData=h,this.limitCropBox(!0,!0),h.width=Math.min(Math.max(h.width,h.minWidth),h.maxWidth),h.height=Math.min(Math.max(h.height,h.minHeight),h.maxHeight),h.width=Math.max(h.minWidth,h.width*l),h.height=Math.max(h.minHeight,h.height*l),h.left=a.left+(a.width-h.width)/2,h.top=a.top+(a.height-h.height)/2,h.oldLeft=h.left,h.oldTop=h.top,this.initialCropBoxData=B({},h)},limitCropBox:function(t,a){var e=this.options,l=this.containerData,h=this.canvasData,p=this.cropBoxData,g=this.limited,b=e.aspectRatio;if(t){var w=Number(e.minCropBoxWidth)||0,m=Number(e.minCropBoxHeight)||0,v=g?Math.min(l.width,h.width,h.width+h.left,l.width-h.left):l.width,y=g?Math.min(l.height,h.height,h.height+h.top,l.height-h.top):l.height;w=Math.min(w,l.width),m=Math.min(m,l.height),b&&(w&&m?m*b>w?m=w/b:w=m*b:w?m=w/b:m&&(w=m*b),y*b>v?y=v/b:v=y*b),p.minWidth=Math.min(w,v),p.minHeight=Math.min(m,y),p.maxWidth=v,p.maxHeight=y}a&&(g?(p.minLeft=Math.max(0,h.left),p.minTop=Math.max(0,h.top),p.maxLeft=Math.min(l.width,h.left+h.width)-p.width,p.maxTop=Math.min(l.height,h.top+h.height)-p.height):(p.minLeft=0,p.minTop=0,p.maxLeft=l.width-p.width,p.maxTop=l.height-p.height))},renderCropBox:function(){var t=this.options,a=this.containerData,e=this.cropBoxData;(e.width>e.maxWidth||e.width<e.minWidth)&&(e.left=e.oldLeft),(e.height>e.maxHeight||e.height<e.minHeight)&&(e.top=e.oldTop),e.width=Math.min(Math.max(e.width,e.minWidth),e.maxWidth),e.height=Math.min(Math.max(e.height,e.minHeight),e.maxHeight),this.limitCropBox(!1,!0),e.left=Math.min(Math.max(e.left,e.minLeft),e.maxLeft),e.top=Math.min(Math.max(e.top,e.minTop),e.maxTop),e.oldLeft=e.left,e.oldTop=e.top,t.movable&&t.cropBoxMovable&&rt(this.face,Dt,e.width>=a.width&&e.height>=a.height?"move":"all"),it(this.cropBox,B({width:e.width,height:e.height},ee({translateX:e.left,translateY:e.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),Xt(this.element,qt,this.getData())}},qe={initPreview:function(){var t=this.element,a=this.crossOrigin,e=this.options.preview,l=a?this.crossOriginUrl:this.url,h=t.alt||"The image to preview",p=document.createElement("img");if(a&&(p.crossOrigin=a),p.src=l,p.alt=h,this.viewBox.appendChild(p),this.viewBoxImage=p,e){var g=e;"string"==typeof e?g=t.ownerDocument.querySelectorAll(e):e.querySelector&&(g=[e]),this.previews=g,N(g,function(b){var w=document.createElement("img");rt(b,Lt,{width:b.offsetWidth,height:b.offsetHeight,html:b.innerHTML}),a&&(w.crossOrigin=a),w.src=l,w.alt=h,w.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',b.innerHTML="",b.appendChild(w)})}},resetPreview:function(){N(this.previews,function(t){var a=lt(t,Lt);it(t,{width:a.width,height:a.height}),t.innerHTML=a.html,function We(s,t){if(ut(s[t]))try{delete s[t]}catch(a){s[t]=void 0}else if(s.dataset)try{delete s.dataset[t]}catch(a){s.dataset[t]=void 0}else s.removeAttribute("data-".concat(Pt(t)))}(t,Lt)})},preview:function(){var t=this.imageData,a=this.canvasData,e=this.cropBoxData,l=e.width,h=e.height,p=t.width,g=t.height,b=e.left-a.left-t.left,w=e.top-a.top-t.top;!this.cropped||this.disabled||(it(this.viewBoxImage,B({width:p,height:g},ee(B({translateX:-b,translateY:-w},t)))),N(this.previews,function(m){var v=lt(m,Lt),y=v.width,T=v.height,S=y,k=T,D=1;l&&(k=h*(D=y/l)),h&&k>T&&(S=l*(D=T/h),k=T),it(m,{width:S,height:k}),it(m.getElementsByTagName("img")[0],B({width:p*D,height:g*D},ee(B({translateX:-b*D,translateY:-w*D},t))))}))}},Je={bind:function(){var t=this.element,a=this.options,e=this.cropper;F(a.cropstart)&&ot(t,Kt,a.cropstart),F(a.cropmove)&&ot(t,ce,a.cropmove),F(a.cropend)&&ot(t,Jt,a.cropend),F(a.crop)&&ot(t,qt,a.crop),F(a.zoom)&&ot(t,r,a.zoom),ot(e,le,this.onCropStart=this.cropStart.bind(this)),a.zoomable&&a.zoomOnWheel&&ot(e,i,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),a.toggleDragModeOnDblclick&&ot(e,pe,this.onDblclick=this.dblclick.bind(this)),ot(t.ownerDocument,de,this.onCropMove=this.cropMove.bind(this)),ot(t.ownerDocument,ye,this.onCropEnd=this.cropEnd.bind(this)),a.responsive&&ot(window,u,this.onResize=this.resize.bind(this))},unbind:function(){var t=this.element,a=this.options,e=this.cropper;F(a.cropstart)&&pt(t,Kt,a.cropstart),F(a.cropmove)&&pt(t,ce,a.cropmove),F(a.cropend)&&pt(t,Jt,a.cropend),F(a.crop)&&pt(t,qt,a.crop),F(a.zoom)&&pt(t,r,a.zoom),pt(e,le,this.onCropStart),a.zoomable&&a.zoomOnWheel&&pt(e,i,this.onWheel,{passive:!1,capture:!0}),a.toggleDragModeOnDblclick&&pt(e,pe,this.onDblclick),pt(t.ownerDocument,de,this.onCropMove),pt(t.ownerDocument,ye,this.onCropEnd),a.responsive&&pt(window,u,this.onResize)}},Ke={resize:function(){if(!this.disabled){var g,b,t=this.options,a=this.container,e=this.containerData,l=a.offsetWidth/e.width,h=a.offsetHeight/e.height,p=Math.abs(l-1)>Math.abs(h-1)?l:h;1!==p&&(t.restore&&(g=this.getCanvasData(),b=this.getCropBoxData()),this.render(),t.restore&&(this.setCanvasData(N(g,function(w,m){g[m]=w*p})),this.setCropBoxData(N(b,function(w,m){b[m]=w*p}))))}},dblclick:function(){this.disabled||"none"===this.options.dragMode||this.setDragMode(function Ut(s,t){return s.classList?s.classList.contains(t):s.className.indexOf(t)>-1}(this.dragBox,Zt)?"move":Gt)},wheel:function(t){var a=this,e=Number(this.options.wheelZoomRatio)||.1,l=1;this.disabled||(t.preventDefault(),!this.wheeling&&(this.wheeling=!0,setTimeout(function(){a.wheeling=!1},50),t.deltaY?l=t.deltaY>0?1:-1:t.wheelDelta?l=-t.wheelDelta/120:t.detail&&(l=t.detail>0?1:-1),this.zoom(-l*e,t)))},cropStart:function(t){var a=t.buttons,e=t.button;if(!(this.disabled||("mousedown"===t.type||"pointerdown"===t.type&&"mouse"===t.pointerType)&&(A(a)&&1!==a||A(e)&&0!==e||t.ctrlKey))){var p,l=this.options,h=this.pointers;t.changedTouches?N(t.changedTouches,function(g){h[g.identifier]=ue(g)}):h[t.pointerId||0]=ue(t),p=Object.keys(h).length>1&&l.zoomable&&l.zoomOnTouch?"zoom":lt(t.target,Dt),n.test(p)&&!1!==Xt(this.element,Kt,{originalEvent:t,action:p})&&(t.preventDefault(),this.action=p,this.cropping=!1,"crop"===p&&(this.cropping=!0,L(this.dragBox,$)))}},cropMove:function(t){var a=this.action;if(!this.disabled&&a){var e=this.pointers;t.preventDefault(),!1!==Xt(this.element,ce,{originalEvent:t,action:a})&&(t.changedTouches?N(t.changedTouches,function(l){B(e[l.identifier]||{},ue(l,!0))}):B(e[t.pointerId||0]||{},ue(t,!0)),this.change(t))}},cropEnd:function(t){if(!this.disabled){var a=this.action,e=this.pointers;t.changedTouches?N(t.changedTouches,function(l){delete e[l.identifier]}):delete e[t.pointerId||0],a&&(t.preventDefault(),Object.keys(e).length||(this.action=""),this.cropping&&(this.cropping=!1,_t(this.dragBox,$,this.cropped&&this.options.modal)),Xt(this.element,Jt,{originalEvent:t,action:a}))}}},$e={change:function(t){var gt,e=this.canvasData,l=this.containerData,h=this.cropBoxData,p=this.pointers,g=this.action,b=this.options.aspectRatio,w=h.left,m=h.top,v=h.width,y=h.height,T=w+v,S=m+y,k=0,D=0,X=l.width,j=l.height,Y=!0;!b&&t.shiftKey&&(b=v&&y?v/y:1),this.limited&&(D=h.minTop,X=(k=h.minLeft)+Math.min(l.width,e.width,e.left+e.width),j=D+Math.min(l.height,e.height,e.top+e.height));var tt=p[Object.keys(p)[0]],M={x:tt.endX-tt.startX,y:tt.endY-tt.startY},z=function(nt){switch(nt){case"e":T+M.x>X&&(M.x=X-T);break;case"w":w+M.x<k&&(M.x=k-w);break;case ft:m+M.y<D&&(M.y=D-m);break;case"s":S+M.y>j&&(M.y=j-S)}};switch(g){case"all":w+=M.x,m+=M.y;break;case"e":if(M.x>=0&&(T>=X||b&&(m<=D||S>=j))){Y=!1;break}z("e"),(v+=M.x)<0&&(g="w",w-=v=-v),b&&(m+=(h.height-(y=v/b))/2);break;case ft:if(M.y<=0&&(m<=D||b&&(w<=k||T>=X))){Y=!1;break}z(ft),m+=M.y,(y-=M.y)<0&&(g="s",m-=y=-y),b&&(w+=(h.width-(v=y*b))/2);break;case"w":if(M.x<=0&&(w<=k||b&&(m<=D||S>=j))){Y=!1;break}z("w"),w+=M.x,(v-=M.x)<0&&(g="e",w-=v=-v),b&&(m+=(h.height-(y=v/b))/2);break;case"s":if(M.y>=0&&(S>=j||b&&(w<=k||T>=X))){Y=!1;break}z("s"),(y+=M.y)<0&&(g=ft,m-=y=-y),b&&(w+=(h.width-(v=y*b))/2);break;case Nt:if(b){if(M.y<=0&&(m<=D||T>=X)){Y=!1;break}z(ft),m+=M.y,v=(y-=M.y)*b}else z(ft),z("e"),M.x>=0?T<X?v+=M.x:M.y<=0&&m<=D&&(Y=!1):v+=M.x,M.y<=0?m>D&&(y-=M.y,m+=M.y):(y-=M.y,m+=M.y);v<0&&y<0?(g=It,m-=y=-y,w-=v=-v):v<0?(g=yt,w-=v=-v):y<0&&(g=Tt,m-=y=-y);break;case yt:if(b){if(M.y<=0&&(m<=D||w<=k)){Y=!1;break}z(ft),m+=M.y,w+=h.width-(v=(y-=M.y)*b)}else z(ft),z("w"),M.x<=0?w>k?(v-=M.x,w+=M.x):M.y<=0&&m<=D&&(Y=!1):(v-=M.x,w+=M.x),M.y<=0?m>D&&(y-=M.y,m+=M.y):(y-=M.y,m+=M.y);v<0&&y<0?(g=Tt,m-=y=-y,w-=v=-v):v<0?(g=Nt,w-=v=-v):y<0&&(g=It,m-=y=-y);break;case It:if(b){if(M.x<=0&&(w<=k||S>=j)){Y=!1;break}z("w"),w+=M.x,y=(v-=M.x)/b}else z("s"),z("w"),M.x<=0?w>k?(v-=M.x,w+=M.x):M.y>=0&&S>=j&&(Y=!1):(v-=M.x,w+=M.x),M.y>=0?S<j&&(y+=M.y):y+=M.y;v<0&&y<0?(g=Nt,m-=y=-y,w-=v=-v):v<0?(g=Tt,w-=v=-v):y<0&&(g=yt,m-=y=-y);break;case Tt:if(b){if(M.x>=0&&(T>=X||S>=j)){Y=!1;break}z("e"),y=(v+=M.x)/b}else z("s"),z("e"),M.x>=0?T<X?v+=M.x:M.y>=0&&S>=j&&(Y=!1):v+=M.x,M.y>=0?S<j&&(y+=M.y):y+=M.y;v<0&&y<0?(g=yt,m-=y=-y,w-=v=-v):v<0?(g=It,w-=v=-v):y<0&&(g=Nt,m-=y=-y);break;case"move":this.move(M.x,M.y),Y=!1;break;case"zoom":this.zoom(function Le(s){var t=V({},s),a=0;return N(s,function(e,l){delete t[l],N(t,function(h){var p=Math.abs(e.startX-h.startX),g=Math.abs(e.startY-h.startY),b=Math.abs(e.endX-h.endX),w=Math.abs(e.endY-h.endY),m=Math.sqrt(p*p+g*g),y=(Math.sqrt(b*b+w*w)-m)/m;Math.abs(y)>Math.abs(a)&&(a=y)})}),a}(p),t),Y=!1;break;case"crop":if(!M.x||!M.y){Y=!1;break}gt=Re(this.cropper),w=tt.startX-gt.left,m=tt.startY-gt.top,v=h.minWidth,y=h.minHeight,M.x>0?g=M.y>0?Tt:Nt:M.x<0&&(w-=v,g=M.y>0?It:yt),M.y<0&&(m-=y),this.cropped||(at(this.cropBox,Z),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0))}Y&&(h.width=v,h.height=y,h.left=w,h.top=m,this.action=g,this.renderCropBox()),N(p,function(Q){Q.startX=Q.endX,Q.startY=Q.endY})}},ti={crop:function(){return this.ready&&!this.cropped&&!this.disabled&&(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&L(this.dragBox,$),at(this.cropBox,Z),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=B({},this.initialImageData),this.canvasData=B({},this.initialCanvasData),this.cropBoxData=B({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(B(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),at(this.dragBox,$),L(this.cropBox,Z)),this},replace:function(t){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!this.disabled&&t&&(this.isImg&&(this.element.src=t),a?(this.url=t,this.image.src=t,this.ready&&(this.viewBoxImage.src=t,N(this.previews,function(e){e.getElementsByTagName("img")[0].src=t}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(t))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,at(this.cropper,oe)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,L(this.cropper,oe)),this},destroy:function(){var t=this.element;return t[R]?(t[R]=void 0,this.isImg&&this.replaced&&(t.src=this.originalUrl),this.uncreate(),this):this},move:function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,e=this.canvasData,l=e.left,h=e.top;return this.moveTo(bt(t)?t:l+Number(t),bt(a)?a:h+Number(a))},moveTo:function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,e=this.canvasData,l=!1;return t=Number(t),a=Number(a),this.ready&&!this.disabled&&this.options.movable&&(A(t)&&(e.left=t,l=!0),A(a)&&(e.top=a,l=!0),l&&this.renderCanvas(!0)),this},zoom:function(t,a){var e=this.canvasData;return t=Number(t),this.zoomTo(e.width*(t=t<0?1/(1-t):1+t)/e.naturalWidth,null,a)},zoomTo:function(t,a,e){var l=this.options,h=this.canvasData,p=h.width,g=h.height,b=h.naturalWidth,w=h.naturalHeight;if((t=Number(t))>=0&&this.ready&&!this.disabled&&l.zoomable){var m=b*t,v=w*t;if(!1===Xt(this.element,r,{ratio:t,oldRatio:p/b,originalEvent:e}))return this;if(e){var y=this.pointers,T=Re(this.cropper),S=y&&Object.keys(y).length?function Ue(s){var t=0,a=0,e=0;return N(s,function(l){t+=l.startX,a+=l.startY,e+=1}),{pageX:t/=e,pageY:a/=e}}(y):{pageX:e.pageX,pageY:e.pageY};h.left-=(S.pageX-T.left-h.left)/p*(m-p),h.top-=(S.pageY-T.top-h.top)/g*(v-g)}else ct(a)&&A(a.x)&&A(a.y)?(h.left-=(a.x-h.left)/p*(m-p),h.top-=(a.y-h.top)/g*(v-g)):(h.left-=(m-p)/2,h.top-=(v-g)/2);h.width=m,h.height=v,this.renderCanvas(!0)}return this},rotate:function(t){return this.rotateTo((this.imageData.rotate||0)+Number(t))},rotateTo:function(t){return A(t=Number(t))&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=t%360,this.renderCanvas(!0,!0)),this},scaleX:function(t){var a=this.imageData.scaleY;return this.scale(t,A(a)?a:1)},scaleY:function(t){var a=this.imageData.scaleX;return this.scale(A(a)?a:1,t)},scale:function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,e=this.imageData,l=!1;return t=Number(t),a=Number(a),this.ready&&!this.disabled&&this.options.scalable&&(A(t)&&(e.scaleX=t,l=!0),A(a)&&(e.scaleY=a,l=!0),l&&this.renderCanvas(!0,!0)),this},getData:function(){var p,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=this.options,e=this.imageData,l=this.canvasData,h=this.cropBoxData;if(this.ready&&this.cropped){var g=e.width/e.naturalWidth;if(N(p={x:h.left-l.left,y:h.top-l.top,width:h.width,height:h.height},function(m,v){p[v]=m/g}),t){var b=Math.round(p.y+p.height),w=Math.round(p.x+p.width);p.x=Math.round(p.x),p.y=Math.round(p.y),p.width=w-p.x,p.height=b-p.y}}else p={x:0,y:0,width:0,height:0};return a.rotatable&&(p.rotate=e.rotate||0),a.scalable&&(p.scaleX=e.scaleX||1,p.scaleY=e.scaleY||1),p},setData:function(t){var a=this.options,e=this.imageData,l=this.canvasData,h={};if(this.ready&&!this.disabled&&ct(t)){var p=!1;a.rotatable&&A(t.rotate)&&t.rotate!==e.rotate&&(e.rotate=t.rotate,p=!0),a.scalable&&(A(t.scaleX)&&t.scaleX!==e.scaleX&&(e.scaleX=t.scaleX,p=!0),A(t.scaleY)&&t.scaleY!==e.scaleY&&(e.scaleY=t.scaleY,p=!0)),p&&this.renderCanvas(!0,!0);var g=e.width/e.naturalWidth;A(t.x)&&(h.left=t.x*g+l.left),A(t.y)&&(h.top=t.y*g+l.top),A(t.width)&&(h.width=t.width*g),A(t.height)&&(h.height=t.height*g),this.setCropBoxData(h)}return this},getContainerData:function(){return this.ready?B({},this.containerData):{}},getImageData:function(){return this.sized?B({},this.imageData):{}},getCanvasData:function(){var t=this.canvasData,a={};return this.ready&&N(["left","top","width","height","naturalWidth","naturalHeight"],function(e){a[e]=t[e]}),a},setCanvasData:function(t){var a=this.canvasData,e=a.aspectRatio;return this.ready&&!this.disabled&&ct(t)&&(A(t.left)&&(a.left=t.left),A(t.top)&&(a.top=t.top),A(t.width)?(a.width=t.width,a.height=t.width/e):A(t.height)&&(a.height=t.height,a.width=t.height*e),this.renderCanvas(!0)),this},getCropBoxData:function(){var a,t=this.cropBoxData;return this.ready&&this.cropped&&(a={left:t.left,top:t.top,width:t.width,height:t.height}),a||{}},setCropBoxData:function(t){var l,h,a=this.cropBoxData,e=this.options.aspectRatio;return this.ready&&this.cropped&&!this.disabled&&ct(t)&&(A(t.left)&&(a.left=t.left),A(t.top)&&(a.top=t.top),A(t.width)&&t.width!==a.width&&(l=!0,a.width=t.width),A(t.height)&&t.height!==a.height&&(h=!0,a.height=t.height),e&&(l?a.height=a.width/e:h&&(a.width=a.height*e)),this.renderCropBox()),this},getCroppedCanvas:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var a=this.canvasData,e=Pe(this.image,this.imageData,a,t);if(!this.cropped)return e;var l=this.getData(),h=l.x,p=l.y,g=l.width,b=l.height,w=e.width/Math.floor(a.naturalWidth);1!==w&&(h*=w,p*=w,g*=w,b*=w);var m=g/b,v=Ct({aspectRatio:m,width:t.maxWidth||1/0,height:t.maxHeight||1/0}),y=Ct({aspectRatio:m,width:t.minWidth||0,height:t.minHeight||0},"cover"),T=Ct({aspectRatio:m,width:t.width||(1!==w?e.width:g),height:t.height||(1!==w?e.height:b)}),S=T.width,k=T.height;S=Math.min(v.width,Math.max(y.width,S)),k=Math.min(v.height,Math.max(y.height,k));var D=document.createElement("canvas"),X=D.getContext("2d");D.width=Mt(S),D.height=Mt(k),X.fillStyle=t.fillColor||"transparent",X.fillRect(0,0,S,k);var j=t.imageSmoothingEnabled,gt=t.imageSmoothingQuality;X.imageSmoothingEnabled=void 0===j||j,gt&&(X.imageSmoothingQuality=gt);var nt,mt,zt,Ht,At,dt,tt=e.width,M=e.height,z=h,Q=p;z<=-g||z>tt?(z=0,nt=0,zt=0,At=0):z<=0?(zt=-z,z=0,At=nt=Math.min(tt,g+z)):z<=tt&&(zt=0,At=nt=Math.min(g,tt-z)),nt<=0||Q<=-b||Q>M?(Q=0,mt=0,Ht=0,dt=0):Q<=0?(Ht=-Q,Q=0,dt=mt=Math.min(M,b+Q)):Q<=M&&(Ht=0,dt=mt=Math.min(b,M-Q));var K=[z,Q,nt,mt];if(At>0&&dt>0){var Bt=S/g;K.push(zt*Bt,Ht*Bt,At*Bt,dt*Bt)}return X.drawImage.apply(X,[e].concat(jt(K.map(function(ge){return Math.floor(Mt(ge))})))),D},setAspectRatio:function(t){var a=this.options;return!this.disabled&&!bt(t)&&(a.aspectRatio=Math.max(0,t)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(t){var a=this.options,e=this.dragBox,l=this.face;if(this.ready&&!this.disabled){var h=t===Gt,p=a.movable&&"move"===t;a.dragMode=t=h||p?t:"none",rt(e,Dt,t),_t(e,Zt,h),_t(e,Vt,p),a.cropBoxMovable||(rt(l,Dt,t),_t(l,Zt,h),_t(l,Vt,p))}return this}},ei=I.Cropper,De=function(){function s(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(St(this,s),!t||!C.test(t.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=t,this.options=B({},O,ct(a)&&a),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return function Rt(s,t,a){return t&&Qt(s.prototype,t),a&&Qt(s,a),Object.defineProperty(s,"prototype",{writable:!1}),s}(s,[{key:"init",value:function(){var l,a=this.element,e=a.tagName.toLowerCase();if(!a[R]){if(a[R]=this,"img"===e){if(this.isImg=!0,l=a.getAttribute("src")||"",this.originalUrl=l,!l)return;l=a.src}else"canvas"===e&&window.HTMLCanvasElement&&(l=a.toDataURL());this.load(l)}}},{key:"load",value:function(a){var e=this;if(a){this.url=a,this.imageData={};var l=this.element,h=this.options;if(!h.rotatable&&!h.scalable&&(h.checkOrientation=!1),!h.checkOrientation||!window.ArrayBuffer)return void this.clone();if(d.test(a))return void(x.test(a)?this.read(function je(s){var t=s.replace(Qe,""),a=atob(t),e=new ArrayBuffer(a.length),l=new Uint8Array(e);return N(l,function(h,p){l[p]=a.charCodeAt(p)}),e}(a)):this.clone());var p=new XMLHttpRequest,g=this.clone.bind(this);this.reloading=!0,this.xhr=p,p.onabort=g,p.onerror=g,p.ontimeout=g,p.onprogress=function(){p.getResponseHeader("content-type")!==o&&p.abort()},p.onload=function(){e.read(p.response)},p.onloadend=function(){e.reloading=!1,e.xhr=null},h.checkCrossOrigin&&Oe(a)&&l.crossOrigin&&(a=Te(a)),p.open("GET",a,!0),p.responseType="arraybuffer",p.withCredentials="use-credentials"===l.crossOrigin,p.send()}}},{key:"read",value:function(a){var e=this.options,l=this.imageData,h=Ze(a),p=0,g=1,b=1;if(h>1){this.url=function Fe(s,t){for(var a=[],l=new Uint8Array(s);l.length>0;)a.push(Ie.apply(null,$t(l.subarray(0,8192)))),l=l.subarray(8192);return"data:".concat(t,";base64,").concat(btoa(a.join("")))}(a,o);var w=function Ve(s){var t=0,a=1,e=1;switch(s){case 2:a=-1;break;case 3:t=-180;break;case 4:e=-1;break;case 5:t=90,e=-1;break;case 6:t=90;break;case 7:t=90,a=-1;break;case 8:t=-90}return{rotate:t,scaleX:a,scaleY:e}}(h);p=w.rotate,g=w.scaleX,b=w.scaleY}e.rotatable&&(l.rotate=p),e.scalable&&(l.scaleX=g,l.scaleY=b),this.clone()}},{key:"clone",value:function(){var a=this.element,e=this.url,l=a.crossOrigin,h=e;this.options.checkCrossOrigin&&Oe(e)&&(l||(l="anonymous"),h=Te(e)),this.crossOrigin=l,this.crossOriginUrl=h;var p=document.createElement("img");l&&(p.crossOrigin=l),p.src=h||e,p.alt=a.alt||"The image to crop",this.image=p,p.onload=this.start.bind(this),p.onerror=this.stop.bind(this),L(p,ne),a.parentNode.insertBefore(p,a.nextSibling)}},{key:"start",value:function(){var a=this,e=this.image;e.onload=null,e.onerror=null,this.sizing=!0;var l=I.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(I.navigator.userAgent),h=function(w,m){B(a.imageData,{naturalWidth:w,naturalHeight:m,aspectRatio:w/m}),a.initialImageData=B({},a.imageData),a.sizing=!1,a.sized=!0,a.build()};if(!e.naturalWidth||l){var p=document.createElement("img"),g=document.body||document.documentElement;this.sizingImage=p,p.onload=function(){h(p.width,p.height),l||g.removeChild(p)},p.src=e.src,l||(p.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",g.appendChild(p))}else h(e.naturalWidth,e.naturalHeight)}},{key:"stop",value:function(){var a=this.image;a.onload=null,a.onerror=null,a.parentNode.removeChild(a),this.image=null}},{key:"build",value:function(){if(this.sized&&!this.ready){var a=this.element,e=this.options,l=this.image,h=a.parentNode,p=document.createElement("div");p.innerHTML='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>';var g=p.querySelector(".".concat(R,"-container")),b=g.querySelector(".".concat(R,"-canvas")),w=g.querySelector(".".concat(R,"-drag-box")),m=g.querySelector(".".concat(R,"-crop-box")),v=m.querySelector(".".concat(R,"-face"));this.container=h,this.cropper=g,this.canvas=b,this.dragBox=w,this.cropBox=m,this.viewBox=g.querySelector(".".concat(R,"-view-box")),this.face=v,b.appendChild(l),L(a,Z),h.insertBefore(g,a.nextSibling),at(l,ne),this.initPreview(),this.bind(),e.initialAspectRatio=Math.max(0,e.initialAspectRatio)||NaN,e.aspectRatio=Math.max(0,e.aspectRatio)||NaN,e.viewMode=Math.max(0,Math.min(3,Math.round(e.viewMode)))||0,L(m,Z),e.guides||L(m.getElementsByClassName("".concat(R,"-dashed")),Z),e.center||L(m.getElementsByClassName("".concat(R,"-center")),Z),e.background&&L(g,"".concat(R,"-bg")),e.highlight||L(v,Ae),e.cropBoxMovable&&(L(v,Vt),rt(v,Dt,"all")),e.cropBoxResizable||(L(m.getElementsByClassName("".concat(R,"-line")),Z),L(m.getElementsByClassName("".concat(R,"-point")),Z)),this.render(),this.ready=!0,this.setDragMode(e.dragMode),e.autoCrop&&this.crop(),this.setData(e.data),F(e.ready)&&ot(a,f,e.ready,{once:!0}),Xt(a,f)}}},{key:"unbuild",value:function(){if(this.ready){this.ready=!1,this.unbind(),this.resetPreview();var a=this.cropper.parentNode;a&&a.removeChild(this.cropper),at(this.element,Z)}}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=ei,s}},{key:"setDefaults",value:function(a){B(O,ct(a)&&a)}}]),s}();return B(De.prototype,Ge,qe,Je,Ke,$e,ti),De}()},3728:(me,Et,V)=>{"use strict";V.d(Et,{ap:()=>le,QG:()=>de});var c=V(5e3);function kt(f,u,i,r){return new(i||(i=Promise))(function(n,d){function x(E){try{_(r.next(E))}catch(O){d(O)}}function C(E){try{_(r.throw(E))}catch(O){d(O)}}function _(E){E.done?n(E.value):function o(n){return n instanceof i?n:new i(function(d){d(n)})}(E.value).then(x,C)}_((r=r.apply(f,u||[])).next())})}var yt=V(9808),Tt=V(2313);const It=["wrapper"],Zt=["sourceImage"];function oe(f,u){if(1&f){const i=c.EpF();c.TgZ(0,"img",4,5),c.NdJ("load",function(){return c.CHM(i),c.oxw().imageLoadedInView()}),c.qZA()}if(2&f){const i=c.oxw();c.Udp("visibility",i.imageVisible?"visible":"hidden")("transform",i.safeTransformStyle),c.Q6J("src",i.safeImgDataUrl,c.LSH)}}function Z(f,u){if(1&f){const i=c.EpF();c.ynx(0),c.TgZ(1,"span",9),c.NdJ("mousedown",function(o){c.CHM(i);const n=c.oxw(2);return n.startMove(o,n.moveTypes.Resize,"topleft")})("touchstart",function(o){c.CHM(i);const n=c.oxw(2);return n.startMove(o,n.moveTypes.Resize,"topleft")}),c._UZ(2,"span",10),c.qZA(),c.TgZ(3,"span",11),c._UZ(4,"span",10),c.qZA(),c.TgZ(5,"span",12),c.NdJ("mousedown",function(o){c.CHM(i);const n=c.oxw(2);return n.startMove(o,n.moveTypes.Resize,"topright")})("touchstart",function(o){c.CHM(i);const n=c.oxw(2);return n.startMove(o,n.moveTypes.Resize,"topright")}),c._UZ(6,"span",10),c.qZA(),c.TgZ(7,"span",13),c._UZ(8,"span",10),c.qZA(),c.TgZ(9,"span",14),c.NdJ("mousedown",function(o){c.CHM(i);const n=c.oxw(2);return n.startMove(o,n.moveTypes.Resize,"bottomright")})("touchstart",function(o){c.CHM(i);const n=c.oxw(2);return n.startMove(o,n.moveTypes.Resize,"bottomright")}),c._UZ(10,"span",10),c.qZA(),c.TgZ(11,"span",15),c._UZ(12,"span",10),c.qZA(),c.TgZ(13,"span",16),c.NdJ("mousedown",function(o){c.CHM(i);const n=c.oxw(2);return n.startMove(o,n.moveTypes.Resize,"bottomleft")})("touchstart",function(o){c.CHM(i);const n=c.oxw(2);return n.startMove(o,n.moveTypes.Resize,"bottomleft")}),c._UZ(14,"span",10),c.qZA(),c.TgZ(15,"span",17),c._UZ(16,"span",10),c.qZA(),c.TgZ(17,"span",18),c.NdJ("mousedown",function(o){c.CHM(i);const n=c.oxw(2);return n.startMove(o,n.moveTypes.Resize,"top")})("touchstart",function(o){c.CHM(i);const n=c.oxw(2);return n.startMove(o,n.moveTypes.Resize,"top")}),c.qZA(),c.TgZ(18,"span",19),c.NdJ("mousedown",function(o){c.CHM(i);const n=c.oxw(2);return n.startMove(o,n.moveTypes.Resize,"right")})("touchstart",function(o){c.CHM(i);const n=c.oxw(2);return n.startMove(o,n.moveTypes.Resize,"right")}),c.qZA(),c.TgZ(19,"span",20),c.NdJ("mousedown",function(o){c.CHM(i);const n=c.oxw(2);return n.startMove(o,n.moveTypes.Resize,"bottom")})("touchstart",function(o){c.CHM(i);const n=c.oxw(2);return n.startMove(o,n.moveTypes.Resize,"bottom")}),c.qZA(),c.TgZ(20,"span",21),c.NdJ("mousedown",function(o){c.CHM(i);const n=c.oxw(2);return n.startMove(o,n.moveTypes.Resize,"left")})("touchstart",function(o){c.CHM(i);const n=c.oxw(2);return n.startMove(o,n.moveTypes.Resize,"left")}),c.qZA(),c.BQk()}}function ne(f,u){if(1&f){const i=c.EpF();c.TgZ(0,"div",6),c.NdJ("keydown",function(o){return c.CHM(i),c.oxw().keyboardAccess(o)}),c.TgZ(1,"div",7),c.NdJ("mousedown",function(o){c.CHM(i);const n=c.oxw();return n.startMove(o,n.moveTypes.Move)})("touchstart",function(o){c.CHM(i);const n=c.oxw();return n.startMove(o,n.moveTypes.Move)}),c.qZA(),c.YNc(2,Z,21,0,"ng-container",8),c.qZA()}if(2&f){const i=c.oxw();c.Udp("top",i.cropper.y1,"px")("left",i.cropper.x1,"px")("width",i.cropper.x2-i.cropper.x1,"px")("height",i.cropper.y2-i.cropper.y1,"px")("margin-left","center"===i.alignImage?i.marginLeft:null)("visibility",i.imageVisible?"visible":"hidden"),c.ekj("rounded",i.roundCropper),c.xp6(2),c.Q6J("ngIf",!i.hideResizeSquares)}}const $={Move:"move",Resize:"resize",Pinch:"pinch"};let Dt=(()=>{class f{crop(i,r,o,n){const d=this.getImagePosition(i,r,o,n),x=d.x2-d.x1,C=d.y2-d.y1,_=document.createElement("canvas");_.width=x,_.height=C;const E=_.getContext("2d");if(!E)return;null!=n.backgroundColor&&(E.fillStyle=n.backgroundColor,E.fillRect(0,0,x,C));const O=(n.transform.scale||1)*(n.transform.flipH?-1:1),H=(n.transform.scale||1)*(n.transform.flipV?-1:1),P=r.transformed;E.setTransform(O,0,0,H,P.size.width/2,P.size.height/2),E.translate(-d.x1/O,-d.y1/H),E.rotate((n.transform.rotate||0)*Math.PI/180),E.drawImage(P.image,-P.size.width/2,-P.size.height/2);const A={width:x,height:C,imagePosition:d,cropperPosition:Object.assign({},o)};n.containWithinAspectRatio&&(A.offsetImagePosition=this.getOffsetImagePosition(i,r,o,n));const q=this.getResizeRatio(x,C,n);return 1!==q&&(A.width=Math.round(x*q),A.height=n.maintainAspectRatio?Math.round(A.width/n.aspectRatio):Math.round(C*q),function Vt(f,u,i){const r=f.width,o=f.height,n=r/(u=Math.round(u)),d=o/(i=Math.round(i)),x=Math.ceil(n/2),C=Math.ceil(d/2),_=f.getContext("2d");if(_){const E=_.getImageData(0,0,r,o),O=_.createImageData(u,i),H=E.data,P=O.data;for(let A=0;A<i;A++)for(let q=0;q<u;q++){const bt=4*(q+A*u),ut=A*d;let ht=0,ct=0,F=0,fe=0,$t=0,N=0,B=0;const be=Math.floor(q*n),Mt=Math.floor(A*d);let te=Math.ceil((q+1)*n),it=Math.ceil((A+1)*d);te=Math.min(te,r),it=Math.min(it,o);for(let Ut=Mt;Ut<it;Ut++){const L=Math.abs(ut-Ut)/C,at=q*n,_t=L*L;for(let Yt=be;Yt<te;Yt++){const Pt=Math.abs(at-Yt)/x,lt=Math.sqrt(_t+Pt*Pt);if(lt>=1)continue;ht=2*lt*lt*lt-3*lt*lt+1;const rt=4*(Yt+Ut*r);B+=ht*H[rt+3],F+=ht,H[rt+3]<255&&(ht=ht*H[rt+3]/250),fe+=ht*H[rt],$t+=ht*H[rt+1],N+=ht*H[rt+2],ct+=ht}}P[bt]=fe/ct,P[bt+1]=$t/ct,P[bt+2]=N/ct,P[bt+3]=B/F}f.width=u,f.height=i,_.putImageData(O,0,0)}}(_,A.width,A.height)),A.base64=_.toDataURL("image/"+n.format,this.getQuality(n)),A}getImagePosition(i,r,o,n){const x=r.transformed.size.width/i.nativeElement.offsetWidth,C={x1:Math.round(o.x1*x),y1:Math.round(o.y1*x),x2:Math.round(o.x2*x),y2:Math.round(o.y2*x)};return n.containWithinAspectRatio||(C.x1=Math.max(C.x1,0),C.y1=Math.max(C.y1,0),C.x2=Math.min(C.x2,r.transformed.size.width),C.y2=Math.min(C.y2,r.transformed.size.height)),C}getOffsetImagePosition(i,r,o,n){const C=r.transformed.size.width/i.nativeElement.offsetWidth;let _,E;(n.canvasRotation+r.exifTransform.rotate)%2?(_=(r.transformed.size.width-r.original.size.height)/2,E=(r.transformed.size.height-r.original.size.width)/2):(_=(r.transformed.size.width-r.original.size.width)/2,E=(r.transformed.size.height-r.original.size.height)/2);const O={x1:Math.round(o.x1*C)-_,y1:Math.round(o.y1*C)-E,x2:Math.round(o.x2*C)-_,y2:Math.round(o.y2*C)-E};return n.containWithinAspectRatio||(O.x1=Math.max(O.x1,0),O.y1=Math.max(O.y1,0),O.x2=Math.min(O.x2,r.transformed.size.width),O.y2=Math.min(O.y2,r.transformed.size.height)),O}getResizeRatio(i,r,o){const n=o.resizeToWidth/i,d=o.resizeToHeight/r,x=new Array;o.resizeToWidth>0&&x.push(n),o.resizeToHeight>0&&x.push(d);const C=0===x.length?1:Math.min(...x);return C>1&&!o.onlyScaleDown?C:Math.min(C,1)}getQuality(i){return Math.min(1,Math.max(0,i.imageQuality/100))}}return f.\u0275fac=function(i){return new(i||f)},f.\u0275prov=(0,c.Yz7)({factory:function(){return new f},token:f,providedIn:"root"}),f})();class Lt{constructor(){this.format="png",this.maintainAspectRatio=!0,this.transform={},this.aspectRatio=1,this.resizeToWidth=0,this.resizeToHeight=0,this.cropperMinWidth=0,this.cropperMinHeight=0,this.cropperMaxHeight=0,this.cropperMaxWidth=0,this.cropperStaticWidth=0,this.cropperStaticHeight=0,this.canvasRotation=0,this.initialStepSize=3,this.roundCropper=!1,this.onlyScaleDown=!1,this.imageQuality=92,this.autoCrop=!0,this.backgroundColor=void 0,this.containWithinAspectRatio=!1,this.hideResizeSquares=!1,this.alignImage="center",this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=this.initialStepSize}setOptions(u){Object.keys(u).filter(i=>i in this).forEach(i=>this[i]=u[i]),this.validateOptions()}setOptionsFromChanges(u){Object.keys(u).filter(i=>i in this).forEach(i=>this[i]=u[i].currentValue),this.validateOptions()}validateOptions(){if(this.maintainAspectRatio&&!this.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}}let Kt=(()=>{class f{constructor(){this.autoRotateSupported=function se(){return new Promise(f=>{const u=new Image;u.onload=()=>{f(1===u.width&&2===u.height)},u.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q=="})}()}loadImageFile(i,r){return new Promise((o,n)=>{const d=new FileReader;d.onload=x=>{this.loadImage(x.target.result,i.type,r).then(o).catch(n)},d.readAsDataURL(i)})}loadImage(i,r,o){return this.isValidImageType(r)?this.loadBase64Image(i,o):Promise.reject(new Error("Invalid image type"))}isValidImageType(i){return/image\/(png|jpg|jpeg|bmp|gif|tiff|webp)/.test(i)}loadImageFromURL(i,r){return new Promise((o,n)=>{const d=new Image;d.onerror=()=>n,d.onload=()=>{const x=document.createElement("canvas"),C=x.getContext("2d");x.width=d.width,x.height=d.height,C.drawImage(d,0,0),this.loadBase64Image(x.toDataURL(),r).then(o)},d.crossOrigin="anonymous",d.src=i})}loadBase64Image(i,r){return new Promise((o,n)=>{const d=new Image;d.onload=()=>o({originalImage:d,originalBase64:i}),d.onerror=n,d.src=i}).then(o=>this.transformImageBase64(o,r))}transformImageBase64(i,r){return kt(this,void 0,void 0,function*(){const o=yield this.autoRotateSupported,n=yield function he(f){switch("string"==typeof f&&(f=function qt(f){const u=new DataView(function Jt(f){f=f.replace(/^data\:([^\;]+)\;base64,/gim,"");const u=atob(f),i=u.length,r=new Uint8Array(i);for(let o=0;o<i;o++)r[o]=u.charCodeAt(o);return r.buffer}(f));if(65496!=u.getUint16(0,!1))return-2;const i=u.byteLength;let r=2;for(;r<i;){if(u.getUint16(r+2,!1)<=8)return-1;const o=u.getUint16(r,!1);if(r+=2,65505==o){if(1165519206!=u.getUint32(r+=2,!1))return-1;const n=18761==u.getUint16(r+=6,!1);r+=u.getUint32(r+4,n);const d=u.getUint16(r,n);r+=2;for(let x=0;x<d;x++)if(274==u.getUint16(r+12*x,n))return u.getUint16(r+12*x+8,n)}else{if(65280!=(65280&o))break;r+=u.getUint16(r,!1)}}return-1}(f)),f){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}(o?-1:i.originalBase64);return i.originalImage&&i.originalImage.complete?this.transformLoadedImage({original:{base64:i.originalBase64,image:i.originalImage,size:{width:i.originalImage.naturalWidth,height:i.originalImage.naturalHeight}},exifTransform:n},r):Promise.reject(new Error("No image loaded"))})}transformLoadedImage(i,r){return kt(this,void 0,void 0,function*(){const o=r.canvasRotation+i.exifTransform.rotate,n={width:i.original.image.naturalWidth,height:i.original.image.naturalHeight};if(0===o&&!i.exifTransform.flip&&!r.containWithinAspectRatio)return{original:{base64:i.original.base64,image:i.original.image,size:Object.assign({},n)},transformed:{base64:i.original.base64,image:i.original.image,size:Object.assign({},n)},exifTransform:i.exifTransform};const d=this.getTransformedSize(n,i.exifTransform,r),x=document.createElement("canvas");x.width=d.width,x.height=d.height;const C=x.getContext("2d");C.setTransform(i.exifTransform.flip?-1:1,0,0,1,x.width/2,x.height/2),C.rotate(Math.PI*(o/2)),C.drawImage(i.original.image,-n.width/2,-n.height/2);const _=x.toDataURL(),E=yield this.loadImageFromBase64(_);return{original:{base64:i.original.base64,image:i.original.image,size:Object.assign({},n)},transformed:{base64:_,image:E,size:{width:E.width,height:E.height}},exifTransform:i.exifTransform}})}loadImageFromBase64(i){return new Promise((r,o)=>{const n=new Image;n.onload=()=>r(n),n.onerror=o,n.src=i})}getTransformedSize(i,r,o){const n=o.canvasRotation+r.rotate;if(o.containWithinAspectRatio){if(n%2){const x=i.height/o.aspectRatio;return{width:Math.max(i.height,i.width*o.aspectRatio),height:Math.max(i.width,x)}}{const x=i.width/o.aspectRatio;return{width:Math.max(i.width,i.height*o.aspectRatio),height:Math.max(i.height,x)}}}return n%2?{height:i.width,width:i.height}:{width:i.width,height:i.height}}}return f.\u0275fac=function(i){return new(i||f)},f.\u0275prov=(0,c.Yz7)({factory:function(){return new f},token:f,providedIn:"root"}),f})(),pe=(()=>{class f{resetCropperPosition(i,r,o){if(!(null==i?void 0:i.nativeElement))return;const n=i.nativeElement;if(o.cropperStaticHeight&&o.cropperStaticWidth)r.x1=0,r.x2=n.offsetWidth>o.cropperStaticWidth?o.cropperStaticWidth:n.offsetWidth,r.y1=0,r.y2=n.offsetHeight>o.cropperStaticHeight?o.cropperStaticHeight:n.offsetHeight;else{const d=Math.min(o.cropperScaledMaxWidth,n.offsetWidth),x=Math.min(o.cropperScaledMaxHeight,n.offsetHeight);if(o.maintainAspectRatio)if(d/o.aspectRatio<x){r.x1=0,r.x2=d;const C=d/o.aspectRatio;r.y1=(n.offsetHeight-C)/2,r.y2=r.y1+C}else{r.y1=0,r.y2=x;const C=x*o.aspectRatio;r.x1=(n.offsetWidth-C)/2,r.x2=r.x1+C}else r.x1=0,r.x2=d,r.y1=0,r.y2=x}}move(i,r,o){const n=this.getClientX(i)-r.clientX,d=this.getClientY(i)-r.clientY;o.x1=r.x1+n,o.y1=r.y1+d,o.x2=r.x2+n,o.y2=r.y2+d}resize(i,r,o,n,d){const x=this.getClientX(i)-r.clientX,C=this.getClientY(i)-r.clientY;switch(r.position){case"left":o.x1=Math.min(Math.max(r.x1+x,o.x2-d.cropperScaledMaxWidth),o.x2-d.cropperScaledMinWidth);break;case"topleft":o.x1=Math.min(Math.max(r.x1+x,o.x2-d.cropperScaledMaxWidth),o.x2-d.cropperScaledMinWidth),o.y1=Math.min(Math.max(r.y1+C,o.y2-d.cropperScaledMaxHeight),o.y2-d.cropperScaledMinHeight);break;case"top":o.y1=Math.min(Math.max(r.y1+C,o.y2-d.cropperScaledMaxHeight),o.y2-d.cropperScaledMinHeight);break;case"topright":o.x2=Math.max(Math.min(r.x2+x,o.x1+d.cropperScaledMaxWidth),o.x1+d.cropperScaledMinWidth),o.y1=Math.min(Math.max(r.y1+C,o.y2-d.cropperScaledMaxHeight),o.y2-d.cropperScaledMinHeight);break;case"right":o.x2=Math.max(Math.min(r.x2+x,o.x1+d.cropperScaledMaxWidth),o.x1+d.cropperScaledMinWidth);break;case"bottomright":o.x2=Math.max(Math.min(r.x2+x,o.x1+d.cropperScaledMaxWidth),o.x1+d.cropperScaledMinWidth),o.y2=Math.max(Math.min(r.y2+C,o.y1+d.cropperScaledMaxHeight),o.y1+d.cropperScaledMinHeight);break;case"bottom":o.y2=Math.max(Math.min(r.y2+C,o.y1+d.cropperScaledMaxHeight),o.y1+d.cropperScaledMinHeight);break;case"bottomleft":o.x1=Math.min(Math.max(r.x1+x,o.x2-d.cropperScaledMaxWidth),o.x2-d.cropperScaledMinWidth),o.y2=Math.max(Math.min(r.y2+C,o.y1+d.cropperScaledMaxHeight),o.y1+d.cropperScaledMinHeight);break;case"center":const _=i.scale,E=Math.min(Math.max(d.cropperScaledMinWidth,Math.abs(r.x2-r.x1)*_),d.cropperScaledMaxWidth),O=Math.min(Math.max(d.cropperScaledMinHeight,Math.abs(r.y2-r.y1)*_),d.cropperScaledMaxHeight);o.x1=r.clientX-E/2,o.x2=r.clientX+E/2,o.y1=r.clientY-O/2,o.y2=r.clientY+O/2,o.x1<0?(o.x2-=o.x1,o.x1=0):o.x2>n.width&&(o.x1-=o.x2-n.width,o.x2=n.width),o.y1<0?(o.y2-=o.y1,o.y1=0):o.y2>n.height&&(o.y1-=o.y2-n.height,o.y2=n.height)}d.maintainAspectRatio&&this.checkAspectRatio(r.position,o,n,d)}checkAspectRatio(i,r,o,n){let d=0,x=0;switch(i){case"top":r.x2=r.x1+(r.y2-r.y1)*n.aspectRatio,d=Math.max(r.x2-o.width,0),x=Math.max(0-r.y1,0),(d>0||x>0)&&(r.x2-=x*n.aspectRatio>d?x*n.aspectRatio:d,r.y1+=x*n.aspectRatio>d?x:d/n.aspectRatio);break;case"bottom":r.x2=r.x1+(r.y2-r.y1)*n.aspectRatio,d=Math.max(r.x2-o.width,0),x=Math.max(r.y2-o.height,0),(d>0||x>0)&&(r.x2-=x*n.aspectRatio>d?x*n.aspectRatio:d,r.y2-=x*n.aspectRatio>d?x:d/n.aspectRatio);break;case"topleft":r.y1=r.y2-(r.x2-r.x1)/n.aspectRatio,d=Math.max(0-r.x1,0),x=Math.max(0-r.y1,0),(d>0||x>0)&&(r.x1+=x*n.aspectRatio>d?x*n.aspectRatio:d,r.y1+=x*n.aspectRatio>d?x:d/n.aspectRatio);break;case"topright":r.y1=r.y2-(r.x2-r.x1)/n.aspectRatio,d=Math.max(r.x2-o.width,0),x=Math.max(0-r.y1,0),(d>0||x>0)&&(r.x2-=x*n.aspectRatio>d?x*n.aspectRatio:d,r.y1+=x*n.aspectRatio>d?x:d/n.aspectRatio);break;case"right":case"bottomright":r.y2=r.y1+(r.x2-r.x1)/n.aspectRatio,d=Math.max(r.x2-o.width,0),x=Math.max(r.y2-o.height,0),(d>0||x>0)&&(r.x2-=x*n.aspectRatio>d?x*n.aspectRatio:d,r.y2-=x*n.aspectRatio>d?x:d/n.aspectRatio);break;case"left":case"bottomleft":r.y2=r.y1+(r.x2-r.x1)/n.aspectRatio,d=Math.max(0-r.x1,0),x=Math.max(r.y2-o.height,0),(d>0||x>0)&&(r.x1+=x*n.aspectRatio>d?x*n.aspectRatio:d,r.y2-=x*n.aspectRatio>d?x:d/n.aspectRatio);break;case"center":r.x2=r.x1+(r.y2-r.y1)*n.aspectRatio,r.y2=r.y1+(r.x2-r.x1)/n.aspectRatio;const C=Math.max(0-r.x1,0),_=Math.max(r.x2-o.width,0),E=Math.max(r.y2-o.height,0),O=Math.max(0-r.y1,0);(C>0||_>0||E>0||O>0)&&(r.x1+=E*n.aspectRatio>C?E*n.aspectRatio:C,r.x2-=O*n.aspectRatio>_?O*n.aspectRatio:_,r.y1+=O*n.aspectRatio>_?O:_/n.aspectRatio,r.y2-=E*n.aspectRatio>C?E:C/n.aspectRatio)}}getClientX(i){return(i.touches&&i.touches[0]?i.touches[0].clientX:i.clientX)||0}getClientY(i){return(i.touches&&i.touches[0]?i.touches[0].clientY:i.clientY)||0}}return f.\u0275fac=function(i){return new(i||f)},f.\u0275prov=(0,c.Yz7)({factory:function(){return new f},token:f,providedIn:"root"}),f})(),le=(()=>{class f{constructor(i,r,o,n,d){this.cropService=i,this.cropperPositionService=r,this.loadImageService=o,this.sanitizer=n,this.cd=d,this.Hammer="undefined"!=typeof window?window.Hammer:null,this.settings=new Lt,this.setImageMaxSizeRetries=0,this.marginLeft="0px",this.moveTypes=$,this.imageVisible=!1,this.format=this.settings.format,this.transform={},this.maintainAspectRatio=this.settings.maintainAspectRatio,this.aspectRatio=this.settings.aspectRatio,this.resizeToWidth=this.settings.resizeToWidth,this.resizeToHeight=this.settings.resizeToHeight,this.cropperMinWidth=this.settings.cropperMinWidth,this.cropperMinHeight=this.settings.cropperMinHeight,this.cropperMaxHeight=this.settings.cropperMaxHeight,this.cropperMaxWidth=this.settings.cropperMaxWidth,this.cropperStaticWidth=this.settings.cropperStaticWidth,this.cropperStaticHeight=this.settings.cropperStaticHeight,this.canvasRotation=this.settings.canvasRotation,this.initialStepSize=this.settings.initialStepSize,this.roundCropper=this.settings.roundCropper,this.onlyScaleDown=this.settings.onlyScaleDown,this.imageQuality=this.settings.imageQuality,this.autoCrop=this.settings.autoCrop,this.backgroundColor=this.settings.backgroundColor,this.containWithinAspectRatio=this.settings.containWithinAspectRatio,this.hideResizeSquares=this.settings.hideResizeSquares,this.cropper={x1:-100,y1:-100,x2:1e4,y2:1e4},this.alignImage=this.settings.alignImage,this.disabled=!1,this.imageCropped=new c.vpe,this.startCropImage=new c.vpe,this.imageLoaded=new c.vpe,this.cropperReady=new c.vpe,this.loadImageFailed=new c.vpe,this.reset()}ngOnChanges(i){this.onChangesUpdateSettings(i),this.onChangesInputImage(i),this.loadedImage&&this.loadedImage.original.image.complete&&(i.containWithinAspectRatio||i.canvasRotation)&&this.loadImageService.transformLoadedImage(this.loadedImage,this.settings).then(r=>this.setLoadedImage(r)).catch(r=>this.loadImageError(r)),(i.cropper||i.maintainAspectRatio||i.aspectRatio)&&(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.maintainAspectRatio&&(i.maintainAspectRatio||i.aspectRatio)?this.resetCropperPosition():i.cropper&&(this.checkCropperPosition(!1),this.doAutoCrop()),this.cd.markForCheck()),i.transform&&(this.transform=this.transform||{},this.setCssTransform(),this.doAutoCrop())}onChangesUpdateSettings(i){this.settings.setOptionsFromChanges(i),this.settings.cropperStaticHeight&&this.settings.cropperStaticWidth&&this.settings.setOptions({hideResizeSquares:!0,cropperMinWidth:this.settings.cropperStaticWidth,cropperMinHeight:this.settings.cropperStaticHeight,cropperMaxHeight:this.settings.cropperStaticHeight,cropperMaxWidth:this.settings.cropperStaticWidth,maintainAspectRatio:!1})}onChangesInputImage(i){(i.imageChangedEvent||i.imageURL||i.imageBase64||i.imageFile)&&this.reset(),i.imageChangedEvent&&this.isValidImageChangedEvent()&&this.loadImageFile(this.imageChangedEvent.target.files[0]),i.imageURL&&this.imageURL&&this.loadImageFromURL(this.imageURL),i.imageBase64&&this.imageBase64&&this.loadBase64Image(this.imageBase64),i.imageFile&&this.imageFile&&this.loadImageFile(this.imageFile)}isValidImageChangedEvent(){return this.imageChangedEvent&&this.imageChangedEvent.target&&this.imageChangedEvent.target.files&&this.imageChangedEvent.target.files.length>0}setCssTransform(){this.safeTransformStyle=this.sanitizer.bypassSecurityTrustStyle("scaleX("+(this.transform.scale||1)*(this.transform.flipH?-1:1)+")scaleY("+(this.transform.scale||1)*(this.transform.flipV?-1:1)+")rotate("+(this.transform.rotate||0)+"deg)")}ngOnInit(){this.settings.stepSize=this.initialStepSize,this.activatePinchGesture()}reset(){this.imageVisible=!1,this.loadedImage=null,this.safeImgDataUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",this.moveStart={active:!1,type:null,position:null,x1:0,y1:0,x2:0,y2:0,clientX:0,clientY:0},this.maxSize={width:0,height:0},this.cropper.x1=-100,this.cropper.y1=-100,this.cropper.x2=1e4,this.cropper.y2=1e4}loadImageFile(i){this.loadImageService.loadImageFile(i,this.settings).then(r=>this.setLoadedImage(r)).catch(r=>this.loadImageError(r))}loadBase64Image(i){this.loadImageService.loadBase64Image(i,this.settings).then(r=>this.setLoadedImage(r)).catch(r=>this.loadImageError(r))}loadImageFromURL(i){this.loadImageService.loadImageFromURL(i,this.settings).then(r=>this.setLoadedImage(r)).catch(r=>this.loadImageError(r))}setLoadedImage(i){this.loadedImage=i,this.safeImgDataUrl=this.sanitizer.bypassSecurityTrustResourceUrl(i.transformed.base64),this.cd.markForCheck()}loadImageError(i){console.error(i),this.loadImageFailed.emit()}imageLoadedInView(){null!=this.loadedImage&&(this.imageLoaded.emit(this.loadedImage),this.setImageMaxSizeRetries=0,setTimeout(()=>this.checkImageMaxSizeRecursively()))}checkImageMaxSizeRecursively(){this.setImageMaxSizeRetries>40?this.loadImageFailed.emit():this.sourceImageLoaded()?(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.resetCropperPosition(),this.cropperReady.emit(Object.assign({},this.maxSize)),this.cd.markForCheck()):(this.setImageMaxSizeRetries++,setTimeout(()=>this.checkImageMaxSizeRecursively(),50))}sourceImageLoaded(){return this.sourceImage&&this.sourceImage.nativeElement&&this.sourceImage.nativeElement.offsetWidth>0}onResize(){!this.loadedImage||(this.resizeCropperPosition(),this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize())}activatePinchGesture(){if(this.Hammer){const i=new this.Hammer(this.wrapper.nativeElement);i.get("pinch").set({enable:!0}),i.on("pinchmove",this.onPinch.bind(this)),i.on("pinchend",this.pinchStop.bind(this)),i.on("pinchstart",this.startPinch.bind(this))}else(0,c.X6Q)()&&console.warn("[NgxImageCropper] Could not find HammerJS - Pinch Gesture won't work")}resizeCropperPosition(){const i=this.sourceImage.nativeElement;(this.maxSize.width!==i.offsetWidth||this.maxSize.height!==i.offsetHeight)&&(this.cropper.x1=this.cropper.x1*i.offsetWidth/this.maxSize.width,this.cropper.x2=this.cropper.x2*i.offsetWidth/this.maxSize.width,this.cropper.y1=this.cropper.y1*i.offsetHeight/this.maxSize.height,this.cropper.y2=this.cropper.y2*i.offsetHeight/this.maxSize.height)}resetCropperPosition(){this.cropperPositionService.resetCropperPosition(this.sourceImage,this.cropper,this.settings),this.doAutoCrop(),this.imageVisible=!0}keyboardAccess(i){this.changeKeyboardStepSize(i),this.keyboardMoveCropper(i)}changeKeyboardStepSize(i){i.key>="1"&&i.key<="9"&&(this.settings.stepSize=+i.key)}keyboardMoveCropper(i){if(!["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(i.key))return;const o=i.shiftKey?$.Resize:$.Move,n=i.altKey?function xe(f){switch(f){case"ArrowUp":return"bottom";case"ArrowRight":return"left";case"ArrowDown":return"top";default:return"right"}}(i.key):function ve(f){switch(f){case"ArrowUp":return"top";case"ArrowRight":return"right";case"ArrowDown":return"bottom";default:return"left"}}(i.key),d=function we(f,u){switch(f){case"ArrowUp":return{clientX:0,clientY:-1*u};case"ArrowRight":return{clientX:u,clientY:0};case"ArrowDown":return{clientX:0,clientY:u};default:return{clientX:-1*u,clientY:0}}}(i.key,this.settings.stepSize);i.preventDefault(),i.stopPropagation(),this.startMove({clientX:0,clientY:0},o,n),this.moveImg(d),this.moveStop()}startMove(i,r,o=null){this.moveStart&&this.moveStart.active&&this.moveStart.type===$.Pinch||(i.preventDefault&&i.preventDefault(),this.moveStart=Object.assign({active:!0,type:r,position:o,clientX:this.cropperPositionService.getClientX(i),clientY:this.cropperPositionService.getClientY(i)},this.cropper))}startPinch(i){!this.safeImgDataUrl||(i.preventDefault&&i.preventDefault(),this.moveStart=Object.assign({active:!0,type:$.Pinch,position:"center",clientX:this.cropper.x1+(this.cropper.x2-this.cropper.x1)/2,clientY:this.cropper.y1+(this.cropper.y2-this.cropper.y1)/2},this.cropper))}moveImg(i){this.moveStart.active&&(i.stopPropagation&&i.stopPropagation(),i.preventDefault&&i.preventDefault(),this.moveStart.type===$.Move?(this.cropperPositionService.move(i,this.moveStart,this.cropper),this.checkCropperPosition(!0)):this.moveStart.type===$.Resize&&(!this.cropperStaticWidth&&!this.cropperStaticHeight&&this.cropperPositionService.resize(i,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1)),this.cd.detectChanges())}onPinch(i){this.moveStart.active&&(i.stopPropagation&&i.stopPropagation(),i.preventDefault&&i.preventDefault(),this.moveStart.type===$.Pinch&&(this.cropperPositionService.resize(i,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1)),this.cd.detectChanges())}setMaxSize(){if(this.sourceImage){const i=this.sourceImage.nativeElement;this.maxSize.width=i.offsetWidth,this.maxSize.height=i.offsetHeight,this.marginLeft=this.sanitizer.bypassSecurityTrustStyle("calc(50% - "+this.maxSize.width/2+"px)")}}setCropperScaledMinSize(){this.loadedImage&&this.loadedImage.transformed&&this.loadedImage.transformed.image?(this.setCropperScaledMinWidth(),this.setCropperScaledMinHeight()):(this.settings.cropperScaledMinWidth=20,this.settings.cropperScaledMinHeight=20)}setCropperScaledMinWidth(){this.settings.cropperScaledMinWidth=this.cropperMinWidth>0?Math.max(20,this.cropperMinWidth/this.loadedImage.transformed.image.width*this.maxSize.width):20}setCropperScaledMinHeight(){this.settings.cropperScaledMinHeight=this.maintainAspectRatio?Math.max(20,this.settings.cropperScaledMinWidth/this.aspectRatio):this.cropperMinHeight>0?Math.max(20,this.cropperMinHeight/this.loadedImage.transformed.image.height*this.maxSize.height):20}setCropperScaledMaxSize(){if(this.loadedImage&&this.loadedImage.transformed&&this.loadedImage.transformed.image){const i=this.loadedImage.transformed.size.width/this.maxSize.width;this.settings.cropperScaledMaxWidth=this.cropperMaxWidth>20?this.cropperMaxWidth/i:this.maxSize.width,this.settings.cropperScaledMaxHeight=this.cropperMaxHeight>20?this.cropperMaxHeight/i:this.maxSize.height,this.maintainAspectRatio&&(this.settings.cropperScaledMaxWidth>this.settings.cropperScaledMaxHeight*this.aspectRatio?this.settings.cropperScaledMaxWidth=this.settings.cropperScaledMaxHeight*this.aspectRatio:this.settings.cropperScaledMaxWidth<this.settings.cropperScaledMaxHeight*this.aspectRatio&&(this.settings.cropperScaledMaxHeight=this.settings.cropperScaledMaxWidth/this.aspectRatio))}else this.settings.cropperScaledMaxWidth=this.maxSize.width,this.settings.cropperScaledMaxHeight=this.maxSize.height}checkCropperPosition(i=!1){this.cropper.x1<0&&(this.cropper.x2-=i?this.cropper.x1:0,this.cropper.x1=0),this.cropper.y1<0&&(this.cropper.y2-=i?this.cropper.y1:0,this.cropper.y1=0),this.cropper.x2>this.maxSize.width&&(this.cropper.x1-=i?this.cropper.x2-this.maxSize.width:0,this.cropper.x2=this.maxSize.width),this.cropper.y2>this.maxSize.height&&(this.cropper.y1-=i?this.cropper.y2-this.maxSize.height:0,this.cropper.y2=this.maxSize.height)}moveStop(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}pinchStop(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}doAutoCrop(){this.autoCrop&&this.crop()}crop(){if(this.sourceImage&&this.sourceImage.nativeElement&&null!=this.loadedImage.transformed.image){this.startCropImage.emit();const i=this.cropService.crop(this.sourceImage,this.loadedImage,this.cropper,this.settings);return null!=i&&this.imageCropped.emit(i),i}return null}}return f.\u0275fac=function(i){return new(i||f)(c.Y36(Dt),c.Y36(pe),c.Y36(Kt),c.Y36(Tt.H7),c.Y36(c.sBO))},f.\u0275cmp=c.Xpm({type:f,selectors:[["image-cropper"]],viewQuery:function(i,r){if(1&i&&(c.Gf(It,7),c.Gf(Zt,5)),2&i){let o;c.iGM(o=c.CRH())&&(r.wrapper=o.first),c.iGM(o=c.CRH())&&(r.sourceImage=o.first)}},hostVars:4,hostBindings:function(i,r){1&i&&c.NdJ("resize",function(){return r.onResize()},!1,c.Jf7)("mousemove",function(n){return r.moveImg(n)},!1,c.evT)("touchmove",function(n){return r.moveImg(n)},!1,c.evT)("mouseup",function(){return r.moveStop()},!1,c.evT)("touchend",function(){return r.moveStop()},!1,c.evT),2&i&&(c.Udp("text-align",r.alignImage),c.ekj("disabled",r.disabled))},inputs:{format:"format",transform:"transform",maintainAspectRatio:"maintainAspectRatio",aspectRatio:"aspectRatio",resizeToWidth:"resizeToWidth",resizeToHeight:"resizeToHeight",cropperMinWidth:"cropperMinWidth",cropperMinHeight:"cropperMinHeight",cropperMaxHeight:"cropperMaxHeight",cropperMaxWidth:"cropperMaxWidth",cropperStaticWidth:"cropperStaticWidth",cropperStaticHeight:"cropperStaticHeight",canvasRotation:"canvasRotation",initialStepSize:"initialStepSize",roundCropper:"roundCropper",onlyScaleDown:"onlyScaleDown",imageQuality:"imageQuality",autoCrop:"autoCrop",backgroundColor:"backgroundColor",containWithinAspectRatio:"containWithinAspectRatio",hideResizeSquares:"hideResizeSquares",cropper:"cropper",alignImage:"alignImage",disabled:"disabled",imageChangedEvent:"imageChangedEvent",imageURL:"imageURL",imageBase64:"imageBase64",imageFile:"imageFile"},outputs:{imageCropped:"imageCropped",startCropImage:"startCropImage",imageLoaded:"imageLoaded",cropperReady:"cropperReady",loadImageFailed:"loadImageFailed"},features:[c.TTD],decls:5,vars:10,consts:[["wrapper",""],["class","source-image",3,"src","visibility","transform","load",4,"ngIf"],[1,"overlay"],["class","cropper","tabindex","0",3,"rounded","top","left","width","height","margin-left","visibility","keydown",4,"ngIf"],[1,"source-image",3,"src","load"],["sourceImage",""],["tabindex","0",1,"cropper",3,"keydown"],[1,"move",3,"mousedown","touchstart"],[4,"ngIf"],[1,"resize","topleft",3,"mousedown","touchstart"],[1,"square"],[1,"resize","top"],[1,"resize","topright",3,"mousedown","touchstart"],[1,"resize","right"],[1,"resize","bottomright",3,"mousedown","touchstart"],[1,"resize","bottom"],[1,"resize","bottomleft",3,"mousedown","touchstart"],[1,"resize","left"],[1,"resize-bar","top",3,"mousedown","touchstart"],[1,"resize-bar","right",3,"mousedown","touchstart"],[1,"resize-bar","bottom",3,"mousedown","touchstart"],[1,"resize-bar","left",3,"mousedown","touchstart"]],template:function(i,r){1&i&&(c.TgZ(0,"div",null,0),c.YNc(2,oe,2,5,"img",1),c._UZ(3,"div",2),c.YNc(4,ne,3,15,"div",3),c.qZA()),2&i&&(c.Udp("background",r.imageVisible&&r.backgroundColor),c.xp6(2),c.Q6J("ngIf",r.safeImgDataUrl),c.xp6(1),c.Udp("width",r.maxSize.width,"px")("height",r.maxSize.height,"px")("margin-left","center"===r.alignImage?r.marginLeft:null),c.xp6(1),c.Q6J("ngIf",r.imageVisible))},directives:[yt.O5],styles:['[_nghost-%COMP%]{display:flex;position:relative;width:100%;max-width:100%;max-height:100%;overflow:hidden;padding:5px;text-align:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:100%;position:relative}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.source-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%;transform-origin:center}[_nghost-%COMP%]   .overlay[_ngcontent-%COMP%]{position:absolute;pointer-events:none;touch-action:none;outline:var(--cropper-overlay-color,#fff) solid 100vw;top:0;left:0}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]{position:absolute;display:flex;color:#53535c;background:0 0;outline:rgba(255,255,255,.3) solid 100vw;outline:var(--cropper-outline-color,rgba(255,255,255,.3)) solid 100vw;touch-action:none}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]:after{position:absolute;content:"";top:0;bottom:0;left:0;right:0;pointer-events:none;border:1px dashed;opacity:.75;color:inherit;z-index:1}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .move[_ngcontent-%COMP%]{width:100%;cursor:move;border:1px solid rgba(255,255,255,.5)}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]:focus   .move[_ngcontent-%COMP%]{border-color:#1e90ff;border-width:2px}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize[_ngcontent-%COMP%]{position:absolute;display:inline-block;line-height:6px;padding:8px;opacity:.85;z-index:1}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize[_ngcontent-%COMP%]   .square[_ngcontent-%COMP%]{display:inline-block;background:#53535c;width:6px;height:6px;border:1px solid rgba(255,255,255,.5);box-sizing:content-box}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.topleft[_ngcontent-%COMP%]{top:-12px;left:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.top[_ngcontent-%COMP%]{top:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.topright[_ngcontent-%COMP%]{top:-12px;right:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.right[_ngcontent-%COMP%]{top:calc(50% - 12px);right:-12px;cursor:ew-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.bottomright[_ngcontent-%COMP%]{bottom:-12px;right:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.bottom[_ngcontent-%COMP%]{bottom:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.bottomleft[_ngcontent-%COMP%]{bottom:-12px;left:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.left[_ngcontent-%COMP%]{top:calc(50% - 12px);left:-12px;cursor:ew-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar[_ngcontent-%COMP%]{position:absolute;z-index:1}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar.top[_ngcontent-%COMP%]{top:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar.right[_ngcontent-%COMP%]{top:11px;right:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar.bottom[_ngcontent-%COMP%]{bottom:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar.left[_ngcontent-%COMP%]{top:11px;left:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .cropper.rounded[_ngcontent-%COMP%]{outline-color:transparent}[_nghost-%COMP%]   .cropper.rounded[_ngcontent-%COMP%]:after{border-radius:100%;box-shadow:0 0 0 100vw rgba(255,255,255,.3);box-shadow:0 0 0 100vw var(--cropper-outline-color,rgba(255,255,255,.3))}@media (orientation:portrait){[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]{outline-width:100vh}[_nghost-%COMP%]   .cropper.rounded[_ngcontent-%COMP%]:after{box-shadow:0 0 0 100vh rgba(255,255,255,.3);box-shadow:0 0 0 100vh var(--cropper-outline-color,rgba(255,255,255,.3))}}[_nghost-%COMP%]   .cropper.rounded[_ngcontent-%COMP%]   .move[_ngcontent-%COMP%]{border-radius:100%}.disabled[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .move[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar[_ngcontent-%COMP%]{display:none}'],changeDetection:0}),f})(),de=(()=>{class f{}return f.\u0275fac=function(i){return new(i||f)},f.\u0275mod=c.oAB({type:f}),f.\u0275inj=c.cJS({imports:[[yt.ez]]}),f})()}}]);