"use strict";(self.webpackChunkfront=self.webpackChunkfront||[]).push([[728],{3728:(ft,L,C)=>{C.d(L,{ap:()=>ht,QG:()=>ct});var o=C(5e3);function H(n,s,t,e){return new(t||(t=Promise))(function(i,r){function h(l){try{c(e.next(l))}catch(d){r(d)}}function p(l){try{c(e.throw(l))}catch(d){r(d)}}function c(l){l.done?i(l.value):function a(i){return i instanceof t?i:new t(function(r){r(i)})}(l.value).then(h,p)}c((e=e.apply(n,s||[])).next())})}var E=C(9808),Z=C(2313);const j=["wrapper"],X=["sourceImage"];function q(n,s){if(1&n){const t=o.EpF();o.TgZ(0,"img",4,5),o.NdJ("load",function(){return o.CHM(t),o.oxw().imageLoadedInView()}),o.qZA()}if(2&n){const t=o.oxw();o.Udp("visibility",t.imageVisible?"visible":"hidden")("transform",t.safeTransformStyle),o.Q6J("src",t.safeImgDataUrl,o.LSH)}}function V(n,s){if(1&n){const t=o.EpF();o.ynx(0),o.TgZ(1,"span",9),o.NdJ("mousedown",function(a){o.CHM(t);const i=o.oxw(2);return i.startMove(a,i.moveTypes.Resize,"topleft")})("touchstart",function(a){o.CHM(t);const i=o.oxw(2);return i.startMove(a,i.moveTypes.Resize,"topleft")}),o._UZ(2,"span",10),o.qZA(),o.TgZ(3,"span",11),o._UZ(4,"span",10),o.qZA(),o.TgZ(5,"span",12),o.NdJ("mousedown",function(a){o.CHM(t);const i=o.oxw(2);return i.startMove(a,i.moveTypes.Resize,"topright")})("touchstart",function(a){o.CHM(t);const i=o.oxw(2);return i.startMove(a,i.moveTypes.Resize,"topright")}),o._UZ(6,"span",10),o.qZA(),o.TgZ(7,"span",13),o._UZ(8,"span",10),o.qZA(),o.TgZ(9,"span",14),o.NdJ("mousedown",function(a){o.CHM(t);const i=o.oxw(2);return i.startMove(a,i.moveTypes.Resize,"bottomright")})("touchstart",function(a){o.CHM(t);const i=o.oxw(2);return i.startMove(a,i.moveTypes.Resize,"bottomright")}),o._UZ(10,"span",10),o.qZA(),o.TgZ(11,"span",15),o._UZ(12,"span",10),o.qZA(),o.TgZ(13,"span",16),o.NdJ("mousedown",function(a){o.CHM(t);const i=o.oxw(2);return i.startMove(a,i.moveTypes.Resize,"bottomleft")})("touchstart",function(a){o.CHM(t);const i=o.oxw(2);return i.startMove(a,i.moveTypes.Resize,"bottomleft")}),o._UZ(14,"span",10),o.qZA(),o.TgZ(15,"span",17),o._UZ(16,"span",10),o.qZA(),o.TgZ(17,"span",18),o.NdJ("mousedown",function(a){o.CHM(t);const i=o.oxw(2);return i.startMove(a,i.moveTypes.Resize,"top")})("touchstart",function(a){o.CHM(t);const i=o.oxw(2);return i.startMove(a,i.moveTypes.Resize,"top")}),o.qZA(),o.TgZ(18,"span",19),o.NdJ("mousedown",function(a){o.CHM(t);const i=o.oxw(2);return i.startMove(a,i.moveTypes.Resize,"right")})("touchstart",function(a){o.CHM(t);const i=o.oxw(2);return i.startMove(a,i.moveTypes.Resize,"right")}),o.qZA(),o.TgZ(19,"span",20),o.NdJ("mousedown",function(a){o.CHM(t);const i=o.oxw(2);return i.startMove(a,i.moveTypes.Resize,"bottom")})("touchstart",function(a){o.CHM(t);const i=o.oxw(2);return i.startMove(a,i.moveTypes.Resize,"bottom")}),o.qZA(),o.TgZ(20,"span",21),o.NdJ("mousedown",function(a){o.CHM(t);const i=o.oxw(2);return i.startMove(a,i.moveTypes.Resize,"left")})("touchstart",function(a){o.CHM(t);const i=o.oxw(2);return i.startMove(a,i.moveTypes.Resize,"left")}),o.qZA(),o.BQk()}}function J(n,s){if(1&n){const t=o.EpF();o.TgZ(0,"div",6),o.NdJ("keydown",function(a){return o.CHM(t),o.oxw().keyboardAccess(a)}),o.TgZ(1,"div",7),o.NdJ("mousedown",function(a){o.CHM(t);const i=o.oxw();return i.startMove(a,i.moveTypes.Move)})("touchstart",function(a){o.CHM(t);const i=o.oxw();return i.startMove(a,i.moveTypes.Move)}),o.qZA(),o.YNc(2,V,21,0,"ng-container",8),o.qZA()}if(2&n){const t=o.oxw();o.Udp("top",t.cropper.y1,"px")("left",t.cropper.x1,"px")("width",t.cropper.x2-t.cropper.x1,"px")("height",t.cropper.y2-t.cropper.y1,"px")("margin-left","center"===t.alignImage?t.marginLeft:null)("visibility",t.imageVisible?"visible":"hidden"),o.ekj("rounded",t.roundCropper),o.xp6(2),o.Q6J("ngIf",!t.hideResizeSquares)}}const x={Move:"move",Resize:"resize",Pinch:"pinch"};let P=(()=>{class n{crop(t,e,a,i){const r=this.getImagePosition(t,e,a,i),h=r.x2-r.x1,p=r.y2-r.y1,c=document.createElement("canvas");c.width=h,c.height=p;const l=c.getContext("2d");if(!l)return;null!=i.backgroundColor&&(l.fillStyle=i.backgroundColor,l.fillRect(0,0,h,p));const d=(i.transform.scale||1)*(i.transform.flipH?-1:1),g=(i.transform.scale||1)*(i.transform.flipV?-1:1),f=e.transformed;l.setTransform(d,0,0,g,f.size.width/2,f.size.height/2),l.translate(-r.x1/d,-r.y1/g),l.rotate((i.transform.rotate||0)*Math.PI/180),l.drawImage(f.image,-f.size.width/2,-f.size.height/2);const m={width:h,height:p,imagePosition:r,cropperPosition:Object.assign({},a)};i.containWithinAspectRatio&&(m.offsetImagePosition=this.getOffsetImagePosition(t,e,a,i));const u=this.getResizeRatio(h,p,i);return 1!==u&&(m.width=Math.round(h*u),m.height=i.maintainAspectRatio?Math.round(m.width/i.aspectRatio):Math.round(p*u),function N(n,s,t){const e=n.width,a=n.height,i=e/(s=Math.round(s)),r=a/(t=Math.round(t)),h=Math.ceil(i/2),p=Math.ceil(r/2),c=n.getContext("2d");if(c){const l=c.getImageData(0,0,e,a),d=c.createImageData(s,t),g=l.data,f=d.data;for(let m=0;m<t;m++)for(let u=0;u<s;u++){const A=4*(u+m*s),pt=m*r;let _=0,v=0,W=0,B=0,Q=0,k=0,U=0;const lt=Math.floor(u*i),dt=Math.floor(m*r);let I=Math.ceil((u+1)*i),z=Math.ceil((m+1)*r);I=Math.min(I,e),z=Math.min(z,a);for(let b=dt;b<z;b++){const F=Math.abs(pt-b)/p,gt=u*i,mt=F*F;for(let S=lt;S<I;S++){const D=Math.abs(gt-S)/h,y=Math.sqrt(mt+D*D);if(y>=1)continue;_=2*y*y*y-3*y*y+1;const M=4*(S+b*e);U+=_*g[M+3],W+=_,g[M+3]<255&&(_=_*g[M+3]/250),B+=_*g[M],Q+=_*g[M+1],k+=_*g[M+2],v+=_}}f[A]=B/v,f[A+1]=Q/v,f[A+2]=k/v,f[A+3]=U/W}n.width=s,n.height=t,c.putImageData(d,0,0)}}(c,m.width,m.height)),m.base64=c.toDataURL("image/"+i.format,this.getQuality(i)),m}getImagePosition(t,e,a,i){const h=e.transformed.size.width/t.nativeElement.offsetWidth,p={x1:Math.round(a.x1*h),y1:Math.round(a.y1*h),x2:Math.round(a.x2*h),y2:Math.round(a.y2*h)};return i.containWithinAspectRatio||(p.x1=Math.max(p.x1,0),p.y1=Math.max(p.y1,0),p.x2=Math.min(p.x2,e.transformed.size.width),p.y2=Math.min(p.y2,e.transformed.size.height)),p}getOffsetImagePosition(t,e,a,i){const p=e.transformed.size.width/t.nativeElement.offsetWidth;let c,l;(i.canvasRotation+e.exifTransform.rotate)%2?(c=(e.transformed.size.width-e.original.size.height)/2,l=(e.transformed.size.height-e.original.size.width)/2):(c=(e.transformed.size.width-e.original.size.width)/2,l=(e.transformed.size.height-e.original.size.height)/2);const d={x1:Math.round(a.x1*p)-c,y1:Math.round(a.y1*p)-l,x2:Math.round(a.x2*p)-c,y2:Math.round(a.y2*p)-l};return i.containWithinAspectRatio||(d.x1=Math.max(d.x1,0),d.y1=Math.max(d.y1,0),d.x2=Math.min(d.x2,e.transformed.size.width),d.y2=Math.min(d.y2,e.transformed.size.height)),d}getResizeRatio(t,e,a){const i=a.resizeToWidth/t,r=a.resizeToHeight/e,h=new Array;a.resizeToWidth>0&&h.push(i),a.resizeToHeight>0&&h.push(r);const p=0===h.length?1:Math.min(...h);return p>1&&!a.onlyScaleDown?p:Math.min(p,1)}getQuality(t){return Math.min(1,Math.max(0,t.imageQuality/100))}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=(0,o.Yz7)({factory:function(){return new n},token:n,providedIn:"root"}),n})();class G{constructor(){this.format="png",this.maintainAspectRatio=!0,this.transform={},this.aspectRatio=1,this.resizeToWidth=0,this.resizeToHeight=0,this.cropperMinWidth=0,this.cropperMinHeight=0,this.cropperMaxHeight=0,this.cropperMaxWidth=0,this.cropperStaticWidth=0,this.cropperStaticHeight=0,this.canvasRotation=0,this.initialStepSize=3,this.roundCropper=!1,this.onlyScaleDown=!1,this.imageQuality=92,this.autoCrop=!0,this.backgroundColor=void 0,this.containWithinAspectRatio=!1,this.hideResizeSquares=!1,this.alignImage="center",this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=this.initialStepSize}setOptions(s){Object.keys(s).filter(t=>t in this).forEach(t=>this[t]=s[t]),this.validateOptions()}setOptionsFromChanges(s){Object.keys(s).filter(t=>t in this).forEach(t=>this[t]=s[t].currentValue),this.validateOptions()}validateOptions(){if(this.maintainAspectRatio&&!this.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}}let at=(()=>{class n{constructor(){this.autoRotateSupported=function $(){return new Promise(n=>{const s=new Image;s.onload=()=>{n(1===s.width&&2===s.height)},s.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q=="})}()}loadImageFile(t,e){return new Promise((a,i)=>{const r=new FileReader;r.onload=h=>{this.loadImage(h.target.result,t.type,e).then(a).catch(i)},r.readAsDataURL(t)})}loadImage(t,e,a){return this.isValidImageType(e)?this.loadBase64Image(t,a):Promise.reject(new Error("Invalid image type"))}isValidImageType(t){return/image\/(png|jpg|jpeg|bmp|gif|tiff|webp)/.test(t)}loadImageFromURL(t,e){return new Promise((a,i)=>{const r=new Image;r.onerror=()=>i,r.onload=()=>{const h=document.createElement("canvas"),p=h.getContext("2d");h.width=r.width,h.height=r.height,p.drawImage(r,0,0),this.loadBase64Image(h.toDataURL(),e).then(a)},r.crossOrigin="anonymous",r.src=t})}loadBase64Image(t,e){return new Promise((a,i)=>{const r=new Image;r.onload=()=>a({originalImage:r,originalBase64:t}),r.onerror=i,r.src=t}).then(a=>this.transformImageBase64(a,e))}transformImageBase64(t,e){return H(this,void 0,void 0,function*(){const a=yield this.autoRotateSupported,i=yield function tt(n){switch("string"==typeof n&&(n=function et(n){const s=new DataView(function it(n){n=n.replace(/^data\:([^\;]+)\;base64,/gim,"");const s=atob(n),t=s.length,e=new Uint8Array(t);for(let a=0;a<t;a++)e[a]=s.charCodeAt(a);return e.buffer}(n));if(65496!=s.getUint16(0,!1))return-2;const t=s.byteLength;let e=2;for(;e<t;){if(s.getUint16(e+2,!1)<=8)return-1;const a=s.getUint16(e,!1);if(e+=2,65505==a){if(1165519206!=s.getUint32(e+=2,!1))return-1;const i=18761==s.getUint16(e+=6,!1);e+=s.getUint32(e+4,i);const r=s.getUint16(e,i);e+=2;for(let h=0;h<r;h++)if(274==s.getUint16(e+12*h,i))return s.getUint16(e+12*h+8,i)}else{if(65280!=(65280&a))break;e+=s.getUint16(e,!1)}}return-1}(n)),n){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}(a?-1:t.originalBase64);return t.originalImage&&t.originalImage.complete?this.transformLoadedImage({original:{base64:t.originalBase64,image:t.originalImage,size:{width:t.originalImage.naturalWidth,height:t.originalImage.naturalHeight}},exifTransform:i},e):Promise.reject(new Error("No image loaded"))})}transformLoadedImage(t,e){return H(this,void 0,void 0,function*(){const a=e.canvasRotation+t.exifTransform.rotate,i={width:t.original.image.naturalWidth,height:t.original.image.naturalHeight};if(0===a&&!t.exifTransform.flip&&!e.containWithinAspectRatio)return{original:{base64:t.original.base64,image:t.original.image,size:Object.assign({},i)},transformed:{base64:t.original.base64,image:t.original.image,size:Object.assign({},i)},exifTransform:t.exifTransform};const r=this.getTransformedSize(i,t.exifTransform,e),h=document.createElement("canvas");h.width=r.width,h.height=r.height;const p=h.getContext("2d");p.setTransform(t.exifTransform.flip?-1:1,0,0,1,h.width/2,h.height/2),p.rotate(Math.PI*(a/2)),p.drawImage(t.original.image,-i.width/2,-i.height/2);const c=h.toDataURL(),l=yield this.loadImageFromBase64(c);return{original:{base64:t.original.base64,image:t.original.image,size:Object.assign({},i)},transformed:{base64:c,image:l,size:{width:l.width,height:l.height}},exifTransform:t.exifTransform}})}loadImageFromBase64(t){return new Promise((e,a)=>{const i=new Image;i.onload=()=>e(i),i.onerror=a,i.src=t})}getTransformedSize(t,e,a){const i=a.canvasRotation+e.rotate;if(a.containWithinAspectRatio){if(i%2){const h=t.height/a.aspectRatio;return{width:Math.max(t.height,t.width*a.aspectRatio),height:Math.max(t.width,h)}}{const h=t.width/a.aspectRatio;return{width:Math.max(t.width,t.height*a.aspectRatio),height:Math.max(t.height,h)}}}return i%2?{height:t.width,width:t.height}:{width:t.width,height:t.height}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=(0,o.Yz7)({factory:function(){return new n},token:n,providedIn:"root"}),n})(),rt=(()=>{class n{resetCropperPosition(t,e,a){if(!(null==t?void 0:t.nativeElement))return;const i=t.nativeElement;if(a.cropperStaticHeight&&a.cropperStaticWidth)e.x1=0,e.x2=i.offsetWidth>a.cropperStaticWidth?a.cropperStaticWidth:i.offsetWidth,e.y1=0,e.y2=i.offsetHeight>a.cropperStaticHeight?a.cropperStaticHeight:i.offsetHeight;else{const r=Math.min(a.cropperScaledMaxWidth,i.offsetWidth),h=Math.min(a.cropperScaledMaxHeight,i.offsetHeight);if(a.maintainAspectRatio)if(r/a.aspectRatio<h){e.x1=0,e.x2=r;const p=r/a.aspectRatio;e.y1=(i.offsetHeight-p)/2,e.y2=e.y1+p}else{e.y1=0,e.y2=h;const p=h*a.aspectRatio;e.x1=(i.offsetWidth-p)/2,e.x2=e.x1+p}else e.x1=0,e.x2=r,e.y1=0,e.y2=h}}move(t,e,a){const i=this.getClientX(t)-e.clientX,r=this.getClientY(t)-e.clientY;a.x1=e.x1+i,a.y1=e.y1+r,a.x2=e.x2+i,a.y2=e.y2+r}resize(t,e,a,i,r){const h=this.getClientX(t)-e.clientX,p=this.getClientY(t)-e.clientY;switch(e.position){case"left":a.x1=Math.min(Math.max(e.x1+h,a.x2-r.cropperScaledMaxWidth),a.x2-r.cropperScaledMinWidth);break;case"topleft":a.x1=Math.min(Math.max(e.x1+h,a.x2-r.cropperScaledMaxWidth),a.x2-r.cropperScaledMinWidth),a.y1=Math.min(Math.max(e.y1+p,a.y2-r.cropperScaledMaxHeight),a.y2-r.cropperScaledMinHeight);break;case"top":a.y1=Math.min(Math.max(e.y1+p,a.y2-r.cropperScaledMaxHeight),a.y2-r.cropperScaledMinHeight);break;case"topright":a.x2=Math.max(Math.min(e.x2+h,a.x1+r.cropperScaledMaxWidth),a.x1+r.cropperScaledMinWidth),a.y1=Math.min(Math.max(e.y1+p,a.y2-r.cropperScaledMaxHeight),a.y2-r.cropperScaledMinHeight);break;case"right":a.x2=Math.max(Math.min(e.x2+h,a.x1+r.cropperScaledMaxWidth),a.x1+r.cropperScaledMinWidth);break;case"bottomright":a.x2=Math.max(Math.min(e.x2+h,a.x1+r.cropperScaledMaxWidth),a.x1+r.cropperScaledMinWidth),a.y2=Math.max(Math.min(e.y2+p,a.y1+r.cropperScaledMaxHeight),a.y1+r.cropperScaledMinHeight);break;case"bottom":a.y2=Math.max(Math.min(e.y2+p,a.y1+r.cropperScaledMaxHeight),a.y1+r.cropperScaledMinHeight);break;case"bottomleft":a.x1=Math.min(Math.max(e.x1+h,a.x2-r.cropperScaledMaxWidth),a.x2-r.cropperScaledMinWidth),a.y2=Math.max(Math.min(e.y2+p,a.y1+r.cropperScaledMaxHeight),a.y1+r.cropperScaledMinHeight);break;case"center":const c=t.scale,l=Math.min(Math.max(r.cropperScaledMinWidth,Math.abs(e.x2-e.x1)*c),r.cropperScaledMaxWidth),d=Math.min(Math.max(r.cropperScaledMinHeight,Math.abs(e.y2-e.y1)*c),r.cropperScaledMaxHeight);a.x1=e.clientX-l/2,a.x2=e.clientX+l/2,a.y1=e.clientY-d/2,a.y2=e.clientY+d/2,a.x1<0?(a.x2-=a.x1,a.x1=0):a.x2>i.width&&(a.x1-=a.x2-i.width,a.x2=i.width),a.y1<0?(a.y2-=a.y1,a.y1=0):a.y2>i.height&&(a.y1-=a.y2-i.height,a.y2=i.height)}r.maintainAspectRatio&&this.checkAspectRatio(e.position,a,i,r)}checkAspectRatio(t,e,a,i){let r=0,h=0;switch(t){case"top":e.x2=e.x1+(e.y2-e.y1)*i.aspectRatio,r=Math.max(e.x2-a.width,0),h=Math.max(0-e.y1,0),(r>0||h>0)&&(e.x2-=h*i.aspectRatio>r?h*i.aspectRatio:r,e.y1+=h*i.aspectRatio>r?h:r/i.aspectRatio);break;case"bottom":e.x2=e.x1+(e.y2-e.y1)*i.aspectRatio,r=Math.max(e.x2-a.width,0),h=Math.max(e.y2-a.height,0),(r>0||h>0)&&(e.x2-=h*i.aspectRatio>r?h*i.aspectRatio:r,e.y2-=h*i.aspectRatio>r?h:r/i.aspectRatio);break;case"topleft":e.y1=e.y2-(e.x2-e.x1)/i.aspectRatio,r=Math.max(0-e.x1,0),h=Math.max(0-e.y1,0),(r>0||h>0)&&(e.x1+=h*i.aspectRatio>r?h*i.aspectRatio:r,e.y1+=h*i.aspectRatio>r?h:r/i.aspectRatio);break;case"topright":e.y1=e.y2-(e.x2-e.x1)/i.aspectRatio,r=Math.max(e.x2-a.width,0),h=Math.max(0-e.y1,0),(r>0||h>0)&&(e.x2-=h*i.aspectRatio>r?h*i.aspectRatio:r,e.y1+=h*i.aspectRatio>r?h:r/i.aspectRatio);break;case"right":case"bottomright":e.y2=e.y1+(e.x2-e.x1)/i.aspectRatio,r=Math.max(e.x2-a.width,0),h=Math.max(e.y2-a.height,0),(r>0||h>0)&&(e.x2-=h*i.aspectRatio>r?h*i.aspectRatio:r,e.y2-=h*i.aspectRatio>r?h:r/i.aspectRatio);break;case"left":case"bottomleft":e.y2=e.y1+(e.x2-e.x1)/i.aspectRatio,r=Math.max(0-e.x1,0),h=Math.max(e.y2-a.height,0),(r>0||h>0)&&(e.x1+=h*i.aspectRatio>r?h*i.aspectRatio:r,e.y2-=h*i.aspectRatio>r?h:r/i.aspectRatio);break;case"center":e.x2=e.x1+(e.y2-e.y1)*i.aspectRatio,e.y2=e.y1+(e.x2-e.x1)/i.aspectRatio;const p=Math.max(0-e.x1,0),c=Math.max(e.x2-a.width,0),l=Math.max(e.y2-a.height,0),d=Math.max(0-e.y1,0);(p>0||c>0||l>0||d>0)&&(e.x1+=l*i.aspectRatio>p?l*i.aspectRatio:p,e.x2-=d*i.aspectRatio>c?d*i.aspectRatio:c,e.y1+=d*i.aspectRatio>c?d:c/i.aspectRatio,e.y2-=l*i.aspectRatio>p?l:p/i.aspectRatio)}}getClientX(t){return(t.touches&&t.touches[0]?t.touches[0].clientX:t.clientX)||0}getClientY(t){return(t.touches&&t.touches[0]?t.touches[0].clientY:t.clientY)||0}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=(0,o.Yz7)({factory:function(){return new n},token:n,providedIn:"root"}),n})(),ht=(()=>{class n{constructor(t,e,a,i,r){this.cropService=t,this.cropperPositionService=e,this.loadImageService=a,this.sanitizer=i,this.cd=r,this.Hammer="undefined"!=typeof window?window.Hammer:null,this.settings=new G,this.setImageMaxSizeRetries=0,this.marginLeft="0px",this.moveTypes=x,this.imageVisible=!1,this.format=this.settings.format,this.transform={},this.maintainAspectRatio=this.settings.maintainAspectRatio,this.aspectRatio=this.settings.aspectRatio,this.resizeToWidth=this.settings.resizeToWidth,this.resizeToHeight=this.settings.resizeToHeight,this.cropperMinWidth=this.settings.cropperMinWidth,this.cropperMinHeight=this.settings.cropperMinHeight,this.cropperMaxHeight=this.settings.cropperMaxHeight,this.cropperMaxWidth=this.settings.cropperMaxWidth,this.cropperStaticWidth=this.settings.cropperStaticWidth,this.cropperStaticHeight=this.settings.cropperStaticHeight,this.canvasRotation=this.settings.canvasRotation,this.initialStepSize=this.settings.initialStepSize,this.roundCropper=this.settings.roundCropper,this.onlyScaleDown=this.settings.onlyScaleDown,this.imageQuality=this.settings.imageQuality,this.autoCrop=this.settings.autoCrop,this.backgroundColor=this.settings.backgroundColor,this.containWithinAspectRatio=this.settings.containWithinAspectRatio,this.hideResizeSquares=this.settings.hideResizeSquares,this.cropper={x1:-100,y1:-100,x2:1e4,y2:1e4},this.alignImage=this.settings.alignImage,this.disabled=!1,this.imageCropped=new o.vpe,this.startCropImage=new o.vpe,this.imageLoaded=new o.vpe,this.cropperReady=new o.vpe,this.loadImageFailed=new o.vpe,this.reset()}ngOnChanges(t){this.onChangesUpdateSettings(t),this.onChangesInputImage(t),this.loadedImage&&this.loadedImage.original.image.complete&&(t.containWithinAspectRatio||t.canvasRotation)&&this.loadImageService.transformLoadedImage(this.loadedImage,this.settings).then(e=>this.setLoadedImage(e)).catch(e=>this.loadImageError(e)),(t.cropper||t.maintainAspectRatio||t.aspectRatio)&&(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.maintainAspectRatio&&(t.maintainAspectRatio||t.aspectRatio)?this.resetCropperPosition():t.cropper&&(this.checkCropperPosition(!1),this.doAutoCrop()),this.cd.markForCheck()),t.transform&&(this.transform=this.transform||{},this.setCssTransform(),this.doAutoCrop())}onChangesUpdateSettings(t){this.settings.setOptionsFromChanges(t),this.settings.cropperStaticHeight&&this.settings.cropperStaticWidth&&this.settings.setOptions({hideResizeSquares:!0,cropperMinWidth:this.settings.cropperStaticWidth,cropperMinHeight:this.settings.cropperStaticHeight,cropperMaxHeight:this.settings.cropperStaticHeight,cropperMaxWidth:this.settings.cropperStaticWidth,maintainAspectRatio:!1})}onChangesInputImage(t){(t.imageChangedEvent||t.imageURL||t.imageBase64||t.imageFile)&&this.reset(),t.imageChangedEvent&&this.isValidImageChangedEvent()&&this.loadImageFile(this.imageChangedEvent.target.files[0]),t.imageURL&&this.imageURL&&this.loadImageFromURL(this.imageURL),t.imageBase64&&this.imageBase64&&this.loadBase64Image(this.imageBase64),t.imageFile&&this.imageFile&&this.loadImageFile(this.imageFile)}isValidImageChangedEvent(){return this.imageChangedEvent&&this.imageChangedEvent.target&&this.imageChangedEvent.target.files&&this.imageChangedEvent.target.files.length>0}setCssTransform(){this.safeTransformStyle=this.sanitizer.bypassSecurityTrustStyle("scaleX("+(this.transform.scale||1)*(this.transform.flipH?-1:1)+")scaleY("+(this.transform.scale||1)*(this.transform.flipV?-1:1)+")rotate("+(this.transform.rotate||0)+"deg)")}ngOnInit(){this.settings.stepSize=this.initialStepSize,this.activatePinchGesture()}reset(){this.imageVisible=!1,this.loadedImage=null,this.safeImgDataUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",this.moveStart={active:!1,type:null,position:null,x1:0,y1:0,x2:0,y2:0,clientX:0,clientY:0},this.maxSize={width:0,height:0},this.cropper.x1=-100,this.cropper.y1=-100,this.cropper.x2=1e4,this.cropper.y2=1e4}loadImageFile(t){this.loadImageService.loadImageFile(t,this.settings).then(e=>this.setLoadedImage(e)).catch(e=>this.loadImageError(e))}loadBase64Image(t){this.loadImageService.loadBase64Image(t,this.settings).then(e=>this.setLoadedImage(e)).catch(e=>this.loadImageError(e))}loadImageFromURL(t){this.loadImageService.loadImageFromURL(t,this.settings).then(e=>this.setLoadedImage(e)).catch(e=>this.loadImageError(e))}setLoadedImage(t){this.loadedImage=t,this.safeImgDataUrl=this.sanitizer.bypassSecurityTrustResourceUrl(t.transformed.base64),this.cd.markForCheck()}loadImageError(t){console.error(t),this.loadImageFailed.emit()}imageLoadedInView(){null!=this.loadedImage&&(this.imageLoaded.emit(this.loadedImage),this.setImageMaxSizeRetries=0,setTimeout(()=>this.checkImageMaxSizeRecursively()))}checkImageMaxSizeRecursively(){this.setImageMaxSizeRetries>40?this.loadImageFailed.emit():this.sourceImageLoaded()?(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.resetCropperPosition(),this.cropperReady.emit(Object.assign({},this.maxSize)),this.cd.markForCheck()):(this.setImageMaxSizeRetries++,setTimeout(()=>this.checkImageMaxSizeRecursively(),50))}sourceImageLoaded(){return this.sourceImage&&this.sourceImage.nativeElement&&this.sourceImage.nativeElement.offsetWidth>0}onResize(){!this.loadedImage||(this.resizeCropperPosition(),this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize())}activatePinchGesture(){if(this.Hammer){const t=new this.Hammer(this.wrapper.nativeElement);t.get("pinch").set({enable:!0}),t.on("pinchmove",this.onPinch.bind(this)),t.on("pinchend",this.pinchStop.bind(this)),t.on("pinchstart",this.startPinch.bind(this))}else(0,o.X6Q)()&&console.warn("[NgxImageCropper] Could not find HammerJS - Pinch Gesture won't work")}resizeCropperPosition(){const t=this.sourceImage.nativeElement;(this.maxSize.width!==t.offsetWidth||this.maxSize.height!==t.offsetHeight)&&(this.cropper.x1=this.cropper.x1*t.offsetWidth/this.maxSize.width,this.cropper.x2=this.cropper.x2*t.offsetWidth/this.maxSize.width,this.cropper.y1=this.cropper.y1*t.offsetHeight/this.maxSize.height,this.cropper.y2=this.cropper.y2*t.offsetHeight/this.maxSize.height)}resetCropperPosition(){this.cropperPositionService.resetCropperPosition(this.sourceImage,this.cropper,this.settings),this.doAutoCrop(),this.imageVisible=!0}keyboardAccess(t){this.changeKeyboardStepSize(t),this.keyboardMoveCropper(t)}changeKeyboardStepSize(t){t.key>="1"&&t.key<="9"&&(this.settings.stepSize=+t.key)}keyboardMoveCropper(t){if(!["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(t.key))return;const a=t.shiftKey?x.Resize:x.Move,i=t.altKey?function ot(n){switch(n){case"ArrowUp":return"bottom";case"ArrowRight":return"left";case"ArrowDown":return"top";default:return"right"}}(t.key):function nt(n){switch(n){case"ArrowUp":return"top";case"ArrowRight":return"right";case"ArrowDown":return"bottom";default:return"left"}}(t.key),r=function st(n,s){switch(n){case"ArrowUp":return{clientX:0,clientY:-1*s};case"ArrowRight":return{clientX:s,clientY:0};case"ArrowDown":return{clientX:0,clientY:s};default:return{clientX:-1*s,clientY:0}}}(t.key,this.settings.stepSize);t.preventDefault(),t.stopPropagation(),this.startMove({clientX:0,clientY:0},a,i),this.moveImg(r),this.moveStop()}startMove(t,e,a=null){this.moveStart&&this.moveStart.active&&this.moveStart.type===x.Pinch||(t.preventDefault&&t.preventDefault(),this.moveStart=Object.assign({active:!0,type:e,position:a,clientX:this.cropperPositionService.getClientX(t),clientY:this.cropperPositionService.getClientY(t)},this.cropper))}startPinch(t){!this.safeImgDataUrl||(t.preventDefault&&t.preventDefault(),this.moveStart=Object.assign({active:!0,type:x.Pinch,position:"center",clientX:this.cropper.x1+(this.cropper.x2-this.cropper.x1)/2,clientY:this.cropper.y1+(this.cropper.y2-this.cropper.y1)/2},this.cropper))}moveImg(t){this.moveStart.active&&(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),this.moveStart.type===x.Move?(this.cropperPositionService.move(t,this.moveStart,this.cropper),this.checkCropperPosition(!0)):this.moveStart.type===x.Resize&&(!this.cropperStaticWidth&&!this.cropperStaticHeight&&this.cropperPositionService.resize(t,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1)),this.cd.detectChanges())}onPinch(t){this.moveStart.active&&(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),this.moveStart.type===x.Pinch&&(this.cropperPositionService.resize(t,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1)),this.cd.detectChanges())}setMaxSize(){if(this.sourceImage){const t=this.sourceImage.nativeElement;this.maxSize.width=t.offsetWidth,this.maxSize.height=t.offsetHeight,this.marginLeft=this.sanitizer.bypassSecurityTrustStyle("calc(50% - "+this.maxSize.width/2+"px)")}}setCropperScaledMinSize(){this.loadedImage&&this.loadedImage.transformed&&this.loadedImage.transformed.image?(this.setCropperScaledMinWidth(),this.setCropperScaledMinHeight()):(this.settings.cropperScaledMinWidth=20,this.settings.cropperScaledMinHeight=20)}setCropperScaledMinWidth(){this.settings.cropperScaledMinWidth=this.cropperMinWidth>0?Math.max(20,this.cropperMinWidth/this.loadedImage.transformed.image.width*this.maxSize.width):20}setCropperScaledMinHeight(){this.settings.cropperScaledMinHeight=this.maintainAspectRatio?Math.max(20,this.settings.cropperScaledMinWidth/this.aspectRatio):this.cropperMinHeight>0?Math.max(20,this.cropperMinHeight/this.loadedImage.transformed.image.height*this.maxSize.height):20}setCropperScaledMaxSize(){if(this.loadedImage&&this.loadedImage.transformed&&this.loadedImage.transformed.image){const t=this.loadedImage.transformed.size.width/this.maxSize.width;this.settings.cropperScaledMaxWidth=this.cropperMaxWidth>20?this.cropperMaxWidth/t:this.maxSize.width,this.settings.cropperScaledMaxHeight=this.cropperMaxHeight>20?this.cropperMaxHeight/t:this.maxSize.height,this.maintainAspectRatio&&(this.settings.cropperScaledMaxWidth>this.settings.cropperScaledMaxHeight*this.aspectRatio?this.settings.cropperScaledMaxWidth=this.settings.cropperScaledMaxHeight*this.aspectRatio:this.settings.cropperScaledMaxWidth<this.settings.cropperScaledMaxHeight*this.aspectRatio&&(this.settings.cropperScaledMaxHeight=this.settings.cropperScaledMaxWidth/this.aspectRatio))}else this.settings.cropperScaledMaxWidth=this.maxSize.width,this.settings.cropperScaledMaxHeight=this.maxSize.height}checkCropperPosition(t=!1){this.cropper.x1<0&&(this.cropper.x2-=t?this.cropper.x1:0,this.cropper.x1=0),this.cropper.y1<0&&(this.cropper.y2-=t?this.cropper.y1:0,this.cropper.y1=0),this.cropper.x2>this.maxSize.width&&(this.cropper.x1-=t?this.cropper.x2-this.maxSize.width:0,this.cropper.x2=this.maxSize.width),this.cropper.y2>this.maxSize.height&&(this.cropper.y1-=t?this.cropper.y2-this.maxSize.height:0,this.cropper.y2=this.maxSize.height)}moveStop(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}pinchStop(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}doAutoCrop(){this.autoCrop&&this.crop()}crop(){if(this.sourceImage&&this.sourceImage.nativeElement&&null!=this.loadedImage.transformed.image){this.startCropImage.emit();const t=this.cropService.crop(this.sourceImage,this.loadedImage,this.cropper,this.settings);return null!=t&&this.imageCropped.emit(t),t}return null}}return n.\u0275fac=function(t){return new(t||n)(o.Y36(P),o.Y36(rt),o.Y36(at),o.Y36(Z.H7),o.Y36(o.sBO))},n.\u0275cmp=o.Xpm({type:n,selectors:[["image-cropper"]],viewQuery:function(t,e){if(1&t&&(o.Gf(j,7),o.Gf(X,5)),2&t){let a;o.iGM(a=o.CRH())&&(e.wrapper=a.first),o.iGM(a=o.CRH())&&(e.sourceImage=a.first)}},hostVars:4,hostBindings:function(t,e){1&t&&o.NdJ("resize",function(){return e.onResize()},!1,o.Jf7)("mousemove",function(i){return e.moveImg(i)},!1,o.evT)("touchmove",function(i){return e.moveImg(i)},!1,o.evT)("mouseup",function(){return e.moveStop()},!1,o.evT)("touchend",function(){return e.moveStop()},!1,o.evT),2&t&&(o.Udp("text-align",e.alignImage),o.ekj("disabled",e.disabled))},inputs:{format:"format",transform:"transform",maintainAspectRatio:"maintainAspectRatio",aspectRatio:"aspectRatio",resizeToWidth:"resizeToWidth",resizeToHeight:"resizeToHeight",cropperMinWidth:"cropperMinWidth",cropperMinHeight:"cropperMinHeight",cropperMaxHeight:"cropperMaxHeight",cropperMaxWidth:"cropperMaxWidth",cropperStaticWidth:"cropperStaticWidth",cropperStaticHeight:"cropperStaticHeight",canvasRotation:"canvasRotation",initialStepSize:"initialStepSize",roundCropper:"roundCropper",onlyScaleDown:"onlyScaleDown",imageQuality:"imageQuality",autoCrop:"autoCrop",backgroundColor:"backgroundColor",containWithinAspectRatio:"containWithinAspectRatio",hideResizeSquares:"hideResizeSquares",cropper:"cropper",alignImage:"alignImage",disabled:"disabled",imageChangedEvent:"imageChangedEvent",imageURL:"imageURL",imageBase64:"imageBase64",imageFile:"imageFile"},outputs:{imageCropped:"imageCropped",startCropImage:"startCropImage",imageLoaded:"imageLoaded",cropperReady:"cropperReady",loadImageFailed:"loadImageFailed"},features:[o.TTD],decls:5,vars:10,consts:[["wrapper",""],["class","source-image",3,"src","visibility","transform","load",4,"ngIf"],[1,"overlay"],["class","cropper","tabindex","0",3,"rounded","top","left","width","height","margin-left","visibility","keydown",4,"ngIf"],[1,"source-image",3,"src","load"],["sourceImage",""],["tabindex","0",1,"cropper",3,"keydown"],[1,"move",3,"mousedown","touchstart"],[4,"ngIf"],[1,"resize","topleft",3,"mousedown","touchstart"],[1,"square"],[1,"resize","top"],[1,"resize","topright",3,"mousedown","touchstart"],[1,"resize","right"],[1,"resize","bottomright",3,"mousedown","touchstart"],[1,"resize","bottom"],[1,"resize","bottomleft",3,"mousedown","touchstart"],[1,"resize","left"],[1,"resize-bar","top",3,"mousedown","touchstart"],[1,"resize-bar","right",3,"mousedown","touchstart"],[1,"resize-bar","bottom",3,"mousedown","touchstart"],[1,"resize-bar","left",3,"mousedown","touchstart"]],template:function(t,e){1&t&&(o.TgZ(0,"div",null,0),o.YNc(2,q,2,5,"img",1),o._UZ(3,"div",2),o.YNc(4,J,3,15,"div",3),o.qZA()),2&t&&(o.Udp("background",e.imageVisible&&e.backgroundColor),o.xp6(2),o.Q6J("ngIf",e.safeImgDataUrl),o.xp6(1),o.Udp("width",e.maxSize.width,"px")("height",e.maxSize.height,"px")("margin-left","center"===e.alignImage?e.marginLeft:null),o.xp6(1),o.Q6J("ngIf",e.imageVisible))},directives:[E.O5],styles:['[_nghost-%COMP%]{display:flex;position:relative;width:100%;max-width:100%;max-height:100%;overflow:hidden;padding:5px;text-align:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:100%;position:relative}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.source-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%;transform-origin:center}[_nghost-%COMP%]   .overlay[_ngcontent-%COMP%]{position:absolute;pointer-events:none;touch-action:none;outline:var(--cropper-overlay-color,#fff) solid 100vw;top:0;left:0}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]{position:absolute;display:flex;color:#53535c;background:0 0;outline:rgba(255,255,255,.3) solid 100vw;outline:var(--cropper-outline-color,rgba(255,255,255,.3)) solid 100vw;touch-action:none}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]:after{position:absolute;content:"";top:0;bottom:0;left:0;right:0;pointer-events:none;border:1px dashed;opacity:.75;color:inherit;z-index:1}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .move[_ngcontent-%COMP%]{width:100%;cursor:move;border:1px solid rgba(255,255,255,.5)}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]:focus   .move[_ngcontent-%COMP%]{border-color:#1e90ff;border-width:2px}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize[_ngcontent-%COMP%]{position:absolute;display:inline-block;line-height:6px;padding:8px;opacity:.85;z-index:1}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize[_ngcontent-%COMP%]   .square[_ngcontent-%COMP%]{display:inline-block;background:#53535c;width:6px;height:6px;border:1px solid rgba(255,255,255,.5);box-sizing:content-box}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.topleft[_ngcontent-%COMP%]{top:-12px;left:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.top[_ngcontent-%COMP%]{top:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.topright[_ngcontent-%COMP%]{top:-12px;right:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.right[_ngcontent-%COMP%]{top:calc(50% - 12px);right:-12px;cursor:ew-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.bottomright[_ngcontent-%COMP%]{bottom:-12px;right:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.bottom[_ngcontent-%COMP%]{bottom:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.bottomleft[_ngcontent-%COMP%]{bottom:-12px;left:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.left[_ngcontent-%COMP%]{top:calc(50% - 12px);left:-12px;cursor:ew-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar[_ngcontent-%COMP%]{position:absolute;z-index:1}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar.top[_ngcontent-%COMP%]{top:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar.right[_ngcontent-%COMP%]{top:11px;right:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar.bottom[_ngcontent-%COMP%]{bottom:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar.left[_ngcontent-%COMP%]{top:11px;left:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .cropper.rounded[_ngcontent-%COMP%]{outline-color:transparent}[_nghost-%COMP%]   .cropper.rounded[_ngcontent-%COMP%]:after{border-radius:100%;box-shadow:0 0 0 100vw rgba(255,255,255,.3);box-shadow:0 0 0 100vw var(--cropper-outline-color,rgba(255,255,255,.3))}@media (orientation:portrait){[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]{outline-width:100vh}[_nghost-%COMP%]   .cropper.rounded[_ngcontent-%COMP%]:after{box-shadow:0 0 0 100vh rgba(255,255,255,.3);box-shadow:0 0 0 100vh var(--cropper-outline-color,rgba(255,255,255,.3))}}[_nghost-%COMP%]   .cropper.rounded[_ngcontent-%COMP%]   .move[_ngcontent-%COMP%]{border-radius:100%}.disabled[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .move[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar[_ngcontent-%COMP%]{display:none}'],changeDetection:0}),n})(),ct=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[[E.ez]]}),n})()}}]);